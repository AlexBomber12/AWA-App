.....s........................sssssss................................... [ 26%]
........................................................................ [ 52%]
........................................................................ [ 79%]
........................................................                 [100%]
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.11.13-final-0 _______________

Name                                                Stmts   Miss  Cover   Missing
---------------------------------------------------------------------------------
packages/awa_common/base.py                             3      0   100%
packages/awa_common/config.py                           4      0   100%
packages/awa_common/db.py                              34      2    94%   40, 43
packages/awa_common/db_url.py                           4      0   100%
packages/awa_common/dsn.py                             96     12    88%   23, 32, 40, 42, 51, 58-60, 87, 95, 101, 167
packages/awa_common/keepa.py                            7      0   100%
packages/awa_common/llm.py                             65      0   100%
packages/awa_common/models_vendor.py                   24      0   100%
services/api/db.py                                     16      3    81%   23-24, 28
services/api/errors.py                                 39      0   100%
services/api/metrics.py                                48     12    75%   44-49, 69-74
services/api/models/fee.py                             11     11     0%   1-14
services/api/roi_repository.py                         21      6    71%   63-68
services/api/routes/health.py                          19      0   100%
services/api/routes/ingest.py                          43      4    91%   28-29, 34, 39
services/api/routes/repository.py                      16      0   100%
services/api/routes/roi.py                             76      4    95%   97, 128-130
services/api/routes/score.py                           56      7    88%   27-33, 40-41, 69
services/api/routes/sku.py                             53      0   100%
services/api/routes/stats.py                           84     21    75%   14-17, 22-23, 32-50, 54-56, 79, 106, 118, 187-188
services/api/routes/upload.py                          22      4    82%   19-22
services/api/security.py                               10      0   100%
services/api/tests/conftest.py                         38      9    76%   13, 25, 39-40, 50, 55-56, 66-67
services/api/tests/test_cors.py                        35      0   100%
services/api/tests/test_entrypoint.py                  19      4    79%   9, 13, 22, 26
services/api/tests/test_errors_json.py                 46     36    22%   15-43, 47-61
services/api/tests/test_health.py                      21     15    29%   11-29
services/api/tests/test_imports.py                      9      0   100%
services/api/tests/test_llm.py                         19      0   100%
services/api/tests/test_metrics_endpoint.py            10      0   100%
services/api/tests/test_rate_limit.py                  45     26    42%   23, 28, 36-42, 46, 51-63, 67-74
services/api/tests/test_roi_basic_auth.py              55      0   100%
services/api/tests/test_roi_filters.py                 36     27    25%   11-14, 18-32, 46-48, 52-75
services/api/tests/test_score.py                       37     27    27%   11-14, 18-32, 44-46, 50-63, 67-71
services/api/tests/test_sentry_event.py                33     18    45%   21-22, 25, 50-70
services/api/tests/test_sentry_scrub.py                16     12    25%   9-31
services/api/tests/test_stats_contracts.py             37     26    30%   12-17, 21-24, 28-35, 39-44, 48-53
services/api/tests/test_stats_future_contracts.py      20     10    50%   13-18, 22, 26-29
services/api/tests/test_stats_sql.py                   39     30    23%   11-14, 18-33, 47-49, 53-77
services/worker/celery_app.py                          66      7    89%   43-44, 127-131
services/worker/copy_loader.py                         57     10    82%   18, 56, 90, 95-98, 101, 106-109
services/worker/email_watcher.py                       50      3    94%   48, 51, 76
services/worker/healthcheck.py                         48     14    71%   17-20, 24-27, 31-35, 56, 58, 70
services/worker/ingest_router.py                        8      0   100%
services/worker/maintenance.py                         40      0   100%
services/worker/metrics.py                             60     11    82%   43-49, 56, 99, 102-103
services/worker/ready.py                               22      2    91%   35-36
services/worker/repricer/app/deps.py                    0      0   100%
services/worker/repricer/app/logic.py                  46      2    96%   15, 61
services/worker/repricer/app/schemas.py                36      0   100%
services/worker/repricer/tests/test_imports.py          9      0   100%
services/worker/repricer/tests/test_smoke.py            7      0   100%
services/worker/tasks.py                               56     15    73%   19-36, 44
services/worker/tests/test_metrics_signals.py          37      1    97%   16
services/worker/tests/test_smoke.py                     7      0   100%
---------------------------------------------------------------------------------
TOTAL                                                1815    391    78%
Coverage XML written to file coverage.xml
Required test coverage of 70.0% reached. Total coverage: 78.46%
