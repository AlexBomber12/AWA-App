E
==================================== ERRORS ====================================
_ ERROR at setup of test_rules_send_russian[check_a1-rows0-\u041c\u0430\u0440\u0436\u0430] _

fixturedef = <FixtureDef argname='migrate_db' scope='session' baseid='tests'>
request = <SubRequest 'migrate_db' for <Coroutine test_rules_send_russian[check_a1-rows0-\u041c\u0430\u0440\u0436\u0430]>>

    @pytest.hookimpl(wrapper=True)
    def pytest_fixture_setup(fixturedef: FixtureDef, request) -> object | None:
        asyncio_mode = _get_asyncio_mode(request.config)
        if not _is_asyncio_fixture_function(fixturedef.func):
            if asyncio_mode == Mode.STRICT:
                # Ignore async fixtures without explicit asyncio mark in strict mode
                # This applies to pytest_trio fixtures, for example
                return (yield)
            if not _is_coroutine_or_asyncgen(fixturedef.func):
>               return (yield)
                        ^^^^^

/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/pytest_asyncio/plugin.py:683: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
tests/conftest.py:133: in migrate_db
    subprocess.check_call(
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

popenargs = (['alembic', '-c', 'services/api/alembic.ini', 'upgrade', 'head'],)
kwargs = {}, retcode = 1
cmd = ['alembic', '-c', 'services/api/alembic.ini', 'upgrade', 'head']

    def check_call(*popenargs, **kwargs):
        """Run command with arguments.  Wait for command to complete.  If
        the exit code was zero then return, otherwise raise
        CalledProcessError.  The CalledProcessError object will have the
        return code in the returncode attribute.
    
        The arguments are the same as for the call function.  Example:
    
        check_call(["ls", "-l"])
        """
        retcode = call(*popenargs, **kwargs)
        if retcode:
            cmd = kwargs.get("args")
            if cmd is None:
                cmd = popenargs[0]
>           raise CalledProcessError(retcode, cmd)
E           subprocess.CalledProcessError: Command '['alembic', '-c', 'services/api/alembic.ini', 'upgrade', 'head']' returned non-zero exit status 1.

/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/subprocess.py:413: CalledProcessError
---------------------------- Captured stderr setup -----------------------------
Traceback (most recent call last):
  File "/opt/hostedtoolcache/Python/3.11.13/x64/bin/alembic", line 7, in <module>
    sys.exit(main())
             ^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/config.py", line 1022, in main
    CommandLine(prog=prog).main(argv=argv)
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/config.py", line 1012, in main
    self.run_cmd(cfg, options)
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/config.py", line 946, in run_cmd
    fn(
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/command.py", line 483, in upgrade
    script.run_env()
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/script/base.py", line 545, in run_env
    util.load_python_file(self.dir, "env.py")
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/util/pyfiles.py", line 116, in load_python_file
    module = load_module_py(module_id, path)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/hostedtoolcache/Python/3.11.13/x64/lib/python3.11/site-packages/alembic/util/pyfiles.py", line 136, in load_module_py
    spec.loader.exec_module(module)  # type: ignore
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap_external>", line 940, in exec_module
  File "<frozen importlib._bootstrap>", line 241, in _call_with_frames_removed
  File "/home/runner/work/AWA-App/AWA-App/services/api/migrations/env.py", line 11, in <module>
    from services.db.utils import views as view_helpers
ModuleNotFoundError: No module named 'services'
=========================== short test summary info ============================
ERROR tests/alerts/test_rules_send_russian.py::test_rules_send_russian[check_a1-rows0-\u041c\u0430\u0440\u0436\u0430] - subprocess.CalledProcessError: Command '['alembic', '-c', 'services/api/alembic.ini', 'upgrade', 'head']' returned non-zero exit status 1.
!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!
