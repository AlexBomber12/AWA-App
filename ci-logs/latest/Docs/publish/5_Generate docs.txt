2025-08-18T14:03:13.4594911Z ##[group]Run pydoc-markdown
2025-08-18T14:03:13.4595212Z [36;1mpydoc-markdown[0m
2025-08-18T14:03:13.4636705Z shell: /usr/bin/bash -e {0}
2025-08-18T14:03:13.4636938Z env:
2025-08-18T14:03:13.4637183Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-18T14:03:13.4637611Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-18T14:03:13.4638036Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-18T14:03:13.4638406Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-18T14:03:13.4638782Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-18T14:03:13.4639144Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-18T14:03:13.4639472Z ##[endgroup]
2025-08-18T14:03:13.8134531Z [WARNING - pydoc_markdown.main]: Unknown configuration options:
2025-08-18T14:03:13.8135410Z Unknown key(s) "{'output_directory'}" at:
2025-08-18T14:03:13.8135796Z In "pydoc-markdown.yml"
2025-08-18T14:03:13.8136150Z   $: TypeHint(pydoc_markdown.PydocMarkdown)
2025-08-18T14:03:13.8136671Z   .renderer: TypeHint(pydoc_markdown.interfaces.Renderer)
2025-08-18T14:03:13.8137280Z   ^: TypeHint(pydoc_markdown.contrib.renderers.markdown.MarkdownRenderer)
2025-08-18T14:03:13.8137696Z 
2025-08-18T14:03:14.1067272Z <a id="__init__"></a>
2025-08-18T14:03:14.1067628Z 
2025-08-18T14:03:14.1067801Z # \_\_init\_\_
2025-08-18T14:03:14.1068009Z 
2025-08-18T14:03:14.1068138Z <a id="api"></a>
2025-08-18T14:03:14.1068411Z 
2025-08-18T14:03:14.1068527Z # api
2025-08-18T14:03:14.1068697Z 
2025-08-18T14:03:14.1068851Z <a id="api.errors"></a>
2025-08-18T14:03:14.1069084Z 
2025-08-18T14:03:14.1069214Z # api.errors
2025-08-18T14:03:14.1069403Z 
2025-08-18T14:03:14.1069569Z <a id="api.tests.test_errors_json"></a>
2025-08-18T14:03:14.1069888Z 
2025-08-18T14:03:14.1070053Z # api.tests.test\_errors\_json
2025-08-18T14:03:14.1070557Z 
2025-08-18T14:03:14.1070715Z <a id="api.tests.test_llm"></a>
2025-08-18T14:03:14.1071000Z 
2025-08-18T14:03:14.1071659Z # api.tests.test\_llm
2025-08-18T14:03:14.1071927Z 
2025-08-18T14:03:14.1072086Z <a id="api.tests.test_cors"></a>
2025-08-18T14:03:14.1072382Z 
2025-08-18T14:03:14.1072527Z # api.tests.test\_cors
2025-08-18T14:03:14.1072762Z 
2025-08-18T14:03:14.1072920Z <a id="api.tests.test_imports"></a>
2025-08-18T14:03:14.1073222Z 
2025-08-18T14:03:14.1073365Z # api.tests.test\_imports
2025-08-18T14:03:14.1073613Z 
2025-08-18T14:03:14.1073786Z <a id="api.tests.test_entrypoint"></a>
2025-08-18T14:03:14.1074118Z 
2025-08-18T14:03:14.1074271Z # api.tests.test\_entrypoint
2025-08-18T14:03:14.1074553Z 
2025-08-18T14:03:14.1074707Z <a id="api.tests.test_health"></a>
2025-08-18T14:03:14.1074996Z 
2025-08-18T14:03:14.1075138Z # api.tests.test\_health
2025-08-18T14:03:14.1075389Z 
2025-08-18T14:03:14.1075537Z <a id="api.logging_config"></a>
2025-08-18T14:03:14.1075806Z 
2025-08-18T14:03:14.1075953Z # api.logging\_config
2025-08-18T14:03:14.1076181Z 
2025-08-18T14:03:14.1076337Z <a id="api.migrations.env"></a>
2025-08-18T14:03:14.1076630Z 
2025-08-18T14:03:14.1076779Z # api.migrations.env
2025-08-18T14:03:14.1077005Z 
2025-08-18T14:03:14.1077230Z <a id="api.migrations.versions.0022_fix_roi_view"></a>
2025-08-18T14:03:14.1077627Z 
2025-08-18T14:03:14.1077836Z # api.migrations.versions.0022\_fix\_roi\_view
2025-08-18T14:03:14.1078196Z 
2025-08-18T14:03:14.1078413Z <a id="api.migrations.versions.0004_fee_cron"></a>
2025-08-18T14:03:14.1078787Z 
2025-08-18T14:03:14.1078965Z # api.migrations.versions.0004\_fee\_cron
2025-08-18T14:03:14.1079305Z 
2025-08-18T14:03:14.1079597Z <a id="api.migrations.versions.3e9d5c5aff2c_rename_fulf_fee"></a>
2025-08-18T14:03:14.1080047Z 
2025-08-18T14:03:14.1080494Z # api.migrations.versions.3e9d5c5aff2c\_rename\_fulf\_fee
2025-08-18T14:03:14.1080929Z 
2025-08-18T14:03:14.1081167Z <a id="api.migrations.versions.0003_vendor_prices"></a>
2025-08-18T14:03:14.1081554Z 
2025-08-18T14:03:14.1081761Z # api.migrations.versions.0003\_vendor\_prices
2025-08-18T14:03:14.1082114Z 
2025-08-18T14:03:14.1082350Z <a id="api.migrations.versions.0024_create_buybox"></a>
2025-08-18T14:03:14.1083110Z 
2025-08-18T14:03:14.1083317Z # api.migrations.versions.0024\_create\_buybox
2025-08-18T14:03:14.1083668Z 
2025-08-18T14:03:14.1083925Z <a id="api.migrations.versions.0002_create_roi_view"></a>
2025-08-18T14:03:14.1084334Z 
2025-08-18T14:03:14.1084541Z # api.migrations.versions.0002\_create\_roi\_view
2025-08-18T14:03:14.1084903Z 
2025-08-18T14:03:14.1085135Z <a id="api.migrations.versions.0006_fix_roi_views"></a>
2025-08-18T14:03:14.1085514Z 
2025-08-18T14:03:14.1085712Z # api.migrations.versions.0006\_fix\_roi\_views
2025-08-18T14:03:14.1086079Z 
2025-08-18T14:03:14.1086317Z <a id="api.migrations.versions.0020_unified_schema"></a>
2025-08-18T14:03:14.1086721Z 
2025-08-18T14:03:14.1086935Z # api.migrations.versions.0020\_unified\_schema
2025-08-18T14:03:14.1087298Z 
2025-08-18T14:03:14.1087569Z <a id="api.migrations.versions.0025_pr4_indexes_loadlog"></a>
2025-08-18T14:03:14.1088000Z 
2025-08-18T14:03:14.1088239Z # api.migrations.versions.0025\_pr4\_indexes\_loadlog
2025-08-18T14:03:14.1088632Z 
2025-08-18T14:03:14.1088867Z <a id="api.migrations.versions.0023_add_storage_fee"></a>
2025-08-18T14:03:14.1089270Z 
2025-08-18T14:03:14.1089472Z # api.migrations.versions.0023\_add\_storage\_fee
2025-08-18T14:03:14.1089833Z 
2025-08-18T14:03:14.1090099Z <a id="api.migrations.versions.0026_amazon_new_reports"></a>
2025-08-18T14:03:14.1090700Z 
2025-08-18T14:03:14.1090925Z # api.migrations.versions.0026\_amazon\_new\_reports
2025-08-18T14:03:14.1091313Z 
2025-08-18T14:03:14.1091519Z <a id="api.migrations.versions.0001_baseline"></a>
2025-08-18T14:03:14.1091886Z 
2025-08-18T14:03:14.1092064Z # api.migrations.versions.0001\_baseline
2025-08-18T14:03:14.1092400Z 
2025-08-18T14:03:14.1092570Z <a id="api.migrations.versions"></a>
2025-08-18T14:03:14.1092883Z 
2025-08-18T14:03:14.1093049Z # api.migrations.versions
2025-08-18T14:03:14.1093305Z 
2025-08-18T14:03:14.1093454Z <a id="api.migrations"></a>
2025-08-18T14:03:14.1093724Z 
2025-08-18T14:03:14.1094076Z # api.migrations
2025-08-18T14:03:14.1094294Z 
2025-08-18T14:03:14.1094423Z <a id="api.db"></a>
2025-08-18T14:03:14.1094640Z 
2025-08-18T14:03:14.1094756Z # api.db
2025-08-18T14:03:14.1094919Z 
2025-08-18T14:03:14.1095075Z <a id="api.routes.stats"></a>
2025-08-18T14:03:14.1095343Z 
2025-08-18T14:03:14.1095472Z # api.routes.stats
2025-08-18T14:03:14.1095681Z 
2025-08-18T14:03:14.1095839Z <a id="api.routes.stats.kpi"></a>
2025-08-18T14:03:14.1096130Z 
2025-08-18T14:03:14.1096245Z #### kpi
2025-08-18T14:03:14.1096419Z 
2025-08-18T14:03:14.1096532Z ```python
2025-08-18T14:03:14.1096842Z @router.get("/stats/kpi")
2025-08-18T14:03:14.1097261Z def kpi() -> List[Dict[str, int]]
2025-08-18T14:03:14.1097644Z ```
2025-08-18T14:03:14.1097795Z 
2025-08-18T14:03:14.1097936Z Return KPI metrics (mock).
2025-08-18T14:03:14.1098182Z 
2025-08-18T14:03:14.1098374Z <a id="api.routes.stats.roi_by_vendor"></a>
2025-08-18T14:03:14.1098704Z 
2025-08-18T14:03:14.1098833Z #### roi\_by\_vendor
2025-08-18T14:03:14.1099063Z 
2025-08-18T14:03:14.1099189Z ```python
2025-08-18T14:03:14.1099502Z @router.get("/stats/roi_by_vendor")
2025-08-18T14:03:14.1100084Z def roi_by_vendor() -> List[Dict[str, int]]
2025-08-18T14:03:14.1100696Z ```
2025-08-18T14:03:14.1100855Z 
2025-08-18T14:03:14.1101006Z Return ROI percent by vendor.
2025-08-18T14:03:14.1101282Z 
2025-08-18T14:03:14.1101451Z <a id="api.routes.stats.roi_trend"></a>
2025-08-18T14:03:14.1101778Z 
2025-08-18T14:03:14.1101908Z #### roi\_trend
2025-08-18T14:03:14.1102099Z 
2025-08-18T14:03:14.1102216Z ```python
2025-08-18T14:03:14.1102525Z @router.get("/stats/roi_trend")
2025-08-18T14:03:14.1102968Z def roi_trend() -> List[Dict[str, int | str]]
2025-08-18T14:03:14.1103408Z ```
2025-08-18T14:03:14.1103560Z 
2025-08-18T14:03:14.1103698Z Return 30-day ROI trend.
2025-08-18T14:03:14.1103945Z 
2025-08-18T14:03:14.1104092Z <a id="api.routes.roi"></a>
2025-08-18T14:03:14.1104345Z 
2025-08-18T14:03:14.1104479Z # api.routes.roi
2025-08-18T14:03:14.1104678Z 
2025-08-18T14:03:14.1104840Z <a id="api.routes.health"></a>
2025-08-18T14:03:14.1105366Z 
2025-08-18T14:03:14.1105499Z # api.routes.health
2025-08-18T14:03:14.1105707Z 
2025-08-18T14:03:14.1105877Z <a id="api.routes.health.MAX_SKEW"></a>
2025-08-18T14:03:14.1106330Z 
2025-08-18T14:03:14.1106449Z #### MAX\_SKEW
2025-08-18T14:03:14.1106634Z 
2025-08-18T14:03:14.1106754Z seconds
2025-08-18T14:03:14.1106913Z 
2025-08-18T14:03:14.1107081Z <a id="api.routes.health.health"></a>
2025-08-18T14:03:14.1107389Z 
2025-08-18T14:03:14.1107510Z #### health
2025-08-18T14:03:14.1107674Z 
2025-08-18T14:03:14.1107794Z ```python
2025-08-18T14:03:14.1108162Z @router.get("/health", include_in_schema=False)
2025-08-18T14:03:14.1108871Z async def health(session: AsyncSession = Depends(get_session)) -> JSONResponse
2025-08-18T14:03:14.1109522Z ```
2025-08-18T14:03:14.1109673Z 
2025-08-18T14:03:14.1109904Z Return 200 when DB reachable and clocks are in sync.
2025-08-18T14:03:14.1110491Z 
2025-08-18T14:03:14.1110660Z <a id="api.routes.repository"></a>
2025-08-18T14:03:14.1110964Z 
2025-08-18T14:03:14.1111110Z # api.routes.repository
2025-08-18T14:03:14.1111330Z 
2025-08-18T14:03:14.1111456Z <a id="api.routes"></a>
2025-08-18T14:03:14.1111668Z 
2025-08-18T14:03:14.1111783Z # api.routes
2025-08-18T14:03:14.1111965Z 
2025-08-18T14:03:14.1112120Z <a id="api.models.fee"></a>
2025-08-18T14:03:14.1112369Z 
2025-08-18T14:03:14.1112492Z # api.models.fee
2025-08-18T14:03:14.1112687Z 
2025-08-18T14:03:14.1112839Z <a id="api.models"></a>
2025-08-18T14:03:14.1113070Z 
2025-08-18T14:03:14.1113189Z # api.models
2025-08-18T14:03:14.1113377Z 
2025-08-18T14:03:14.1113531Z <a id="api.roi_repository"></a>
2025-08-18T14:03:14.1113802Z 
2025-08-18T14:03:14.1113945Z # api.roi\_repository
2025-08-18T14:03:14.1114169Z 
2025-08-18T14:03:14.1114298Z <a id="api.main"></a>
2025-08-18T14:03:14.1114511Z 
2025-08-18T14:03:14.1114634Z # api.main
2025-08-18T14:03:14.1114807Z 
2025-08-18T14:03:14.1114952Z <a id="api.main.ready"></a>
2025-08-18T14:03:14.1115209Z 
2025-08-18T14:03:14.1115339Z #### ready
2025-08-18T14:03:14.1115747Z 
2025-08-18T14:03:14.1115887Z ```python
2025-08-18T14:03:14.1116383Z @app.get("/ready", status_code=status.HTTP_200_OK, include_in_schema=False)
2025-08-18T14:03:14.1117222Z async def ready(session: AsyncSession = Depends(get_session)) -> dict[str,
2025-08-18T14:03:14.1117884Z                                                                       str]
2025-08-18T14:03:14.1118324Z ```
2025-08-18T14:03:14.1118476Z 
2025-08-18T14:03:14.1118660Z Return 200 only when migrations are at head.
2025-08-18T14:03:14.1118999Z 
2025-08-18T14:03:14.1119137Z <a id="api.config"></a>
2025-08-18T14:03:14.1119370Z 
2025-08-18T14:03:14.1119496Z # api.config
2025-08-18T14:03:14.1119671Z 
2025-08-18T14:03:14.1119787Z <a id="etl"></a>
2025-08-18T14:03:14.1119985Z 
2025-08-18T14:03:14.1120091Z # etl
2025-08-18T14:03:14.1120468Z 
2025-08-18T14:03:14.1120621Z <a id="etl.fba_fee_ingestor"></a>
2025-08-18T14:03:14.1120912Z 
2025-08-18T14:03:14.1121071Z # etl.fba\_fee\_ingestor
2025-08-18T14:03:14.1121312Z 
2025-08-18T14:03:14.1121466Z <a id="etl.sp_fees_ingestor"></a>
2025-08-18T14:03:14.1121744Z 
2025-08-18T14:03:14.1121935Z # etl.sp\_fees\_ingestor
2025-08-18T14:03:14.1122179Z 
2025-08-18T14:03:14.1122329Z <a id="etl.keepa_ingestor"></a>
2025-08-18T14:03:14.1122592Z 
2025-08-18T14:03:14.1122720Z # etl.keepa\_ingestor
2025-08-18T14:03:14.1122942Z 
2025-08-18T14:03:14.1123064Z <a id="etl.db"></a>
2025-08-18T14:03:14.1123266Z 
2025-08-18T14:03:14.1123450Z # etl.db
2025-08-18T14:03:14.1123611Z 
2025-08-18T14:03:14.1123772Z <a id="etl.dialects.schemas"></a>
2025-08-18T14:03:14.1124051Z 
2025-08-18T14:03:14.1124184Z # etl.dialects.schemas
2025-08-18T14:03:14.1124419Z 
2025-08-18T14:03:14.1124613Z <a id="etl.dialects.amazon_reimbursements"></a>
2025-08-18T14:03:14.1124971Z 
2025-08-18T14:03:14.1125134Z # etl.dialects.amazon\_reimbursements
2025-08-18T14:03:14.1125450Z 
2025-08-18T14:03:14.1125631Z <a id="etl.dialects.amazon_ads_sp_cost"></a>
2025-08-18T14:03:14.1125959Z 
2025-08-18T14:03:14.1126124Z # etl.dialects.amazon\_ads\_sp\_cost
2025-08-18T14:03:14.1126657Z 
2025-08-18T14:03:14.1126836Z <a id="etl.dialects.amazon_returns"></a>
2025-08-18T14:03:14.1127166Z 
2025-08-18T14:03:14.1127318Z # etl.dialects.amazon\_returns
2025-08-18T14:03:14.1127589Z 
2025-08-18T14:03:14.1127773Z <a id="etl.dialects.amazon_fee_preview"></a>
2025-08-18T14:03:14.1128120Z 
2025-08-18T14:03:14.1128277Z # etl.dialects.amazon\_fee\_preview
2025-08-18T14:03:14.1128573Z 
2025-08-18T14:03:14.1128783Z <a id="etl.dialects.amazon_inventory_ledger"></a>
2025-08-18T14:03:14.1129145Z 
2025-08-18T14:03:14.1129319Z # etl.dialects.amazon\_inventory\_ledger
2025-08-18T14:03:14.1129644Z 
2025-08-18T14:03:14.1129825Z <a id="etl.dialects.amazon_settlements"></a>
2025-08-18T14:03:14.1130324Z 
2025-08-18T14:03:14.1130490Z # etl.dialects.amazon\_settlements
2025-08-18T14:03:14.1130793Z 
2025-08-18T14:03:14.1130934Z <a id="etl.dialects"></a>
2025-08-18T14:03:14.1131176Z 
2025-08-18T14:03:14.1131304Z # etl.dialects
2025-08-18T14:03:14.1131488Z 
2025-08-18T14:03:14.1131618Z <a id="ingest"></a>
2025-08-18T14:03:14.1131839Z 
2025-08-18T14:03:14.1131948Z # ingest
2025-08-18T14:03:14.1132107Z 
2025-08-18T14:03:14.1132257Z <a id="ingest.maintenance"></a>
2025-08-18T14:03:14.1132534Z 
2025-08-18T14:03:14.1132664Z # ingest.maintenance
2025-08-18T14:03:14.1132885Z 
2025-08-18T14:03:14.1133039Z <a id="ingest.copy_loader"></a>
2025-08-18T14:03:14.1133306Z 
2025-08-18T14:03:14.1133434Z # ingest.copy\_loader
2025-08-18T14:03:14.1133657Z 
2025-08-18T14:03:14.1133847Z <a id="ingest.copy_loader.copy_df_via_temp"></a>
2025-08-18T14:03:14.1134196Z 
2025-08-18T14:03:14.1134330Z #### copy\_df\_via\_temp
2025-08-18T14:03:14.1134569Z 
2025-08-18T14:03:14.1134687Z ```python
2025-08-18T14:03:14.1135010Z def copy_df_via_temp(engine: Engine,
2025-08-18T14:03:14.1135451Z                      df: pd.DataFrame,
2025-08-18T14:03:14.1135889Z                      target_table: str,
2025-08-18T14:03:14.1136291Z                      *,
2025-08-18T14:03:14.1136682Z                      target_schema: Optional[str] = None,
2025-08-18T14:03:14.1137405Z                      columns: Sequence[str],
2025-08-18T14:03:14.1137928Z                      conflict_cols: Optional[Sequence[str]] = None,
2025-08-18T14:03:14.1138450Z                      analyze_after: bool = False,
2025-08-18T14:03:14.1138955Z                      connection: Any | None = None) -> int
2025-08-18T14:03:14.1139404Z ```
2025-08-18T14:03:14.1139568Z 
2025-08-18T14:03:14.1139861Z Bulk load *df* into *target_table* using COPY and a staging table.
2025-08-18T14:03:14.1140471Z 
2025-08-18T14:03:14.1140642Z <a id="ingest.tests.test_smoke"></a>
2025-08-18T14:03:14.1140944Z 
2025-08-18T14:03:14.1141091Z # ingest.tests.test\_smoke
2025-08-18T14:03:14.1141347Z 
2025-08-18T14:03:14.1141485Z <a id="ingest.tests"></a>
2025-08-18T14:03:14.1141730Z 
2025-08-18T14:03:14.1141859Z # ingest.tests
2025-08-18T14:03:14.1142048Z 
2025-08-18T14:03:14.1142205Z <a id="ingest.upload_router"></a>
2025-08-18T14:03:14.1142484Z 
2025-08-18T14:03:14.1142627Z # ingest.upload\_router
2025-08-18T14:03:14.1142872Z 
2025-08-18T14:03:14.1143020Z <a id="ingest.email_watcher"></a>
2025-08-18T14:03:14.1143306Z 
2025-08-18T14:03:14.1143443Z # ingest.email\_watcher
2025-08-18T14:03:14.1143662Z 
2025-08-18T14:03:14.1143824Z <a id="ingest.email_watcher.main"></a>
2025-08-18T14:03:14.1144142Z 
2025-08-18T14:03:14.1144255Z #### main
2025-08-18T14:03:14.1144418Z 
2025-08-18T14:03:14.1144539Z ```python
2025-08-18T14:03:14.1144841Z def main() -> dict[str, str]
2025-08-18T14:03:14.1145213Z ```
2025-08-18T14:03:14.1145368Z 
2025-08-18T14:03:14.1145627Z Upload CSV/XLSX attachments to MinIO and trigger ingestion.
2025-08-18T14:03:14.1146064Z 
2025-08-18T14:03:14.1146311Z Returns {"status": "success"} when processing completes.
2025-08-18T14:03:14.1146712Z 
2025-08-18T14:03:14.1146859Z <a id="ingest.tasks"></a>
2025-08-18T14:03:14.1147099Z 
2025-08-18T14:03:14.1147219Z # ingest.tasks
2025-08-18T14:03:14.1147410Z 
2025-08-18T14:03:14.1147597Z <a id="ingest.tasks.task_import_file"></a>
2025-08-18T14:03:14.1147934Z 
2025-08-18T14:03:14.1148296Z #### task\_import\_file
2025-08-18T14:03:14.1148537Z 
2025-08-18T14:03:14.1148655Z ```python
2025-08-18T14:03:14.1149055Z @celery_app.task(name="ingest.import_file", bind=True)
2025-08-18T14:03:14.1149598Z def task_import_file(self,
2025-08-18T14:03:14.1149969Z                      uri: str,
2025-08-18T14:03:14.1150563Z                      report_type: Optional[str] = None,
2025-08-18T14:03:14.1151082Z                      force: bool = False) -> Dict[str, Any]
2025-08-18T14:03:14.1151522Z ```
2025-08-18T14:03:14.1151684Z 
2025-08-18T14:03:14.1151935Z Import a file into Postgres using existing ETL pipeline.
2025-08-18T14:03:14.1152334Z 
2025-08-18T14:03:14.1152482Z <a id="ingest.celery_app"></a>
2025-08-18T14:03:14.1152752Z 
2025-08-18T14:03:14.1152886Z # ingest.celery\_app
2025-08-18T14:03:14.1153103Z 
2025-08-18T14:03:14.1153258Z <a id="ingest.ingest_router"></a>
2025-08-18T14:03:14.1153537Z 
2025-08-18T14:03:14.1153677Z # ingest.ingest\_router
2025-08-18T14:03:14.1153922Z 
2025-08-18T14:03:14.1154070Z <a id="logistics_etl"></a>
2025-08-18T14:03:14.1154309Z 
2025-08-18T14:03:14.1154434Z # logistics\_etl
2025-08-18T14:03:14.1154639Z 
2025-08-18T14:03:14.1154776Z Daily logistics ETL job.
2025-08-18T14:03:14.1155010Z 
2025-08-18T14:03:14.1155166Z <a id="logistics_etl.__main__"></a>
2025-08-18T14:03:14.1155457Z 
2025-08-18T14:03:14.1155598Z # logistics\_etl.\_\_main\_\_
2025-08-18T14:03:14.1155889Z 
2025-08-18T14:03:14.1156031Z <a id="logistics_etl.dsn"></a>
2025-08-18T14:03:14.1156302Z 
2025-08-18T14:03:14.1156428Z # logistics\_etl.dsn
2025-08-18T14:03:14.1156642Z 
2025-08-18T14:03:14.1156865Z Local DSN builder to avoid cross-service dependency.
2025-08-18T14:03:14.1157259Z 
2025-08-18T14:03:14.1157427Z <a id="logistics_etl.dsn.build_dsn"></a>
2025-08-18T14:03:14.1157745Z 
2025-08-18T14:03:14.1157875Z #### build\_dsn
2025-08-18T14:03:14.1158065Z 
2025-08-18T14:03:14.1158181Z ```python
2025-08-18T14:03:14.1158515Z def build_dsn(sync: bool = True) -> str
2025-08-18T14:03:14.1159322Z ```
2025-08-18T14:03:14.1159501Z 
2025-08-18T14:03:14.1159770Z Return a Postgres DSN assembled from environment variables.
2025-08-18T14:03:14.1160401Z 
2025-08-18T14:03:14.1160705Z Prefers explicit DSNs via ``PG_SYNC_DSN``/``PG_ASYNC_DSN`` or
2025-08-18T14:03:14.1161443Z ``DATABASE_URL``. Falls back to individual PG_* settings and raises an
2025-08-18T14:03:14.1162095Z error when any required variable is missing.
2025-08-18T14:03:14.1162430Z 
2025-08-18T14:03:14.1162604Z <a id="logistics_etl.tests.conftest"></a>
2025-08-18T14:03:14.1162948Z 
2025-08-18T14:03:14.1163107Z # logistics\_etl.tests.conftest
2025-08-18T14:03:14.1163377Z 
2025-08-18T14:03:14.1163579Z <a id="logistics_etl.tests.test_repository"></a>
2025-08-18T14:03:14.1163940Z 
2025-08-18T14:03:14.1164106Z # logistics\_etl.tests.test\_repository
2025-08-18T14:03:14.1164419Z 
2025-08-18T14:03:14.1164605Z <a id="logistics_etl.tests.test_cron"></a>
2025-08-18T14:03:14.1164940Z 
2025-08-18T14:03:14.1165098Z # logistics\_etl.tests.test\_cron
2025-08-18T14:03:14.1165406Z 
2025-08-18T14:03:14.1165593Z <a id="logistics_etl.tests.test_imports"></a>
2025-08-18T14:03:14.1165928Z 
2025-08-18T14:03:14.1166092Z # logistics\_etl.tests.test\_imports
2025-08-18T14:03:14.1166390Z 
2025-08-18T14:03:14.1166565Z <a id="logistics_etl.tests.test_smoke"></a>
2025-08-18T14:03:14.1166889Z 
2025-08-18T14:03:14.1167054Z # logistics\_etl.tests.test\_smoke
2025-08-18T14:03:14.1167340Z 
2025-08-18T14:03:14.1167519Z <a id="logistics_etl.tests.test_client"></a>
2025-08-18T14:03:14.1167857Z 
2025-08-18T14:03:14.1168011Z # logistics\_etl.tests.test\_client
2025-08-18T14:03:14.1168277Z 
2025-08-18T14:03:14.1168426Z <a id="logistics_etl.tests"></a>
2025-08-18T14:03:14.1168684Z 
2025-08-18T14:03:14.1168809Z # logistics\_etl.tests
2025-08-18T14:03:14.1169011Z 
2025-08-18T14:03:14.1169164Z <a id="logistics_etl.flow"></a>
2025-08-18T14:03:14.1169426Z 
2025-08-18T14:03:14.1169556Z # logistics\_etl.flow
2025-08-18T14:03:14.1169781Z 
2025-08-18T14:03:14.1169930Z <a id="logistics_etl.client"></a>
2025-08-18T14:03:14.1170951Z 
2025-08-18T14:03:14.1171099Z # logistics\_etl.client
2025-08-18T14:03:14.1171345Z 
2025-08-18T14:03:14.1171500Z <a id="logistics_etl.cron"></a>
2025-08-18T14:03:14.1171788Z 
2025-08-18T14:03:14.1171933Z # logistics\_etl.cron
2025-08-18T14:03:14.1172154Z 
2025-08-18T14:03:14.1172299Z <a id="logistics_etl.db"></a>
2025-08-18T14:03:14.1172568Z 
2025-08-18T14:03:14.1172694Z # logistics\_etl.db
2025-08-18T14:03:14.1172896Z 
2025-08-18T14:03:14.1173059Z <a id="logistics_etl.repository"></a>
2025-08-18T14:03:14.1173376Z 
2025-08-18T14:03:14.1173524Z # logistics\_etl.repository
2025-08-18T14:03:14.1173775Z 
2025-08-18T14:03:14.1173910Z <a id="alert_bot"></a>
2025-08-18T14:03:14.1174130Z 
2025-08-18T14:03:14.1174245Z # alert\_bot
2025-08-18T14:03:14.1174433Z 
2025-08-18T14:03:14.1174592Z <a id="alert_bot.tests.test_smoke"></a>
2025-08-18T14:03:14.1174904Z 
2025-08-18T14:03:14.1175053Z # alert\_bot.tests.test\_smoke
2025-08-18T14:03:14.1175325Z 
2025-08-18T14:03:14.1175474Z <a id="alert_bot.tests"></a>
2025-08-18T14:03:14.1175734Z 
2025-08-18T14:03:14.1175863Z # alert\_bot.tests
2025-08-18T14:03:14.1176059Z 
2025-08-18T14:03:14.1176208Z <a id="alert_bot.alert_bot"></a>
2025-08-18T14:03:14.1176477Z 
2025-08-18T14:03:14.1176618Z # alert\_bot.alert\_bot
2025-08-18T14:03:14.1176841Z 
2025-08-18T14:03:14.1176979Z <a id="alert_bot.rules"></a>
2025-08-18T14:03:14.1177242Z 
2025-08-18T14:03:14.1177361Z # alert\_bot.rules
2025-08-18T14:03:14.1177555Z 
2025-08-18T14:03:14.1177689Z <a id="common"></a>
2025-08-18T14:03:14.1177889Z 
2025-08-18T14:03:14.1178000Z # common
2025-08-18T14:03:14.1178162Z 
2025-08-18T14:03:14.1178303Z <a id="common.dsn"></a>
2025-08-18T14:03:14.1178525Z 
2025-08-18T14:03:14.1178638Z # common.dsn
2025-08-18T14:03:14.1178820Z 
2025-08-18T14:03:14.1178972Z <a id="common.dsn.build_dsn"></a>
2025-08-18T14:03:14.1179260Z 
2025-08-18T14:03:14.1179378Z #### build\_dsn
2025-08-18T14:03:14.1179578Z 
2025-08-18T14:03:14.1179695Z ```python
2025-08-18T14:03:14.1180027Z def build_dsn(sync: bool = True) -> str
2025-08-18T14:03:14.1180880Z ```
2025-08-18T14:03:14.1181039Z 
2025-08-18T14:03:14.1181285Z Return a Postgres DSN, validating required variables.
2025-08-18T14:03:14.1181687Z 
2025-08-18T14:03:14.1182047Z The function prefers explicit DSNs via ``PG_SYNC_DSN`` / ``PG_ASYNC_DSN`` or
2025-08-18T14:03:14.1182884Z ``DATABASE_URL``.  If those are absent it assembles a connection string from
2025-08-18T14:03:14.1183661Z ``PG_HOST`` and related variables and raises a helpful error when any are
2025-08-18T14:03:14.1205208Z missing.
2025-08-18T14:03:14.1205403Z 
2025-08-18T14:03:14.1205561Z <a id="common.models_vendor"></a>
2025-08-18T14:03:14.1205829Z 
2025-08-18T14:03:14.1206030Z # common.models\_vendor
2025-08-18T14:03:14.1206238Z 
2025-08-18T14:03:14.1206384Z <a id="common.models_vendor.Vendor"></a>
2025-08-18T14:03:14.1206647Z 
2025-08-18T14:03:14.1206769Z ## Vendor Objects
2025-08-18T14:03:14.1206939Z 
2025-08-18T14:03:14.1207041Z ```python
2025-08-18T14:03:14.1207304Z class Vendor(Base)
2025-08-18T14:03:14.1207576Z ```
2025-08-18T14:03:14.1207722Z 
2025-08-18T14:03:14.1207841Z Vendor of inventory items.
2025-08-18T14:03:14.1208059Z 
2025-08-18T14:03:14.1208224Z <a id="common.models_vendor.VendorPrice"></a>
2025-08-18T14:03:14.1208520Z 
2025-08-18T14:03:14.1208643Z ## VendorPrice Objects
2025-08-18T14:03:14.1208831Z 
2025-08-18T14:03:14.1208938Z ```python
2025-08-18T14:03:14.1209189Z class VendorPrice(Base)
2025-08-18T14:03:14.1209474Z ```
2025-08-18T14:03:14.1209600Z 
2025-08-18T14:03:14.1209762Z Association table linking vendors to pricing.
2025-08-18T14:03:14.1210055Z 
2025-08-18T14:03:14.1210380Z <a id="common.db_url"></a>
2025-08-18T14:03:14.1210737Z 
2025-08-18T14:03:14.1210844Z # common.db\_url
2025-08-18T14:03:14.1211008Z 
2025-08-18T14:03:14.1211131Z <a id="common.db_url.build_url"></a>
2025-08-18T14:03:14.1211373Z 
2025-08-18T14:03:14.1211481Z #### build\_url
2025-08-18T14:03:14.1211634Z 
2025-08-18T14:03:14.1211730Z ```python
2025-08-18T14:03:14.1212002Z def build_url(async_: bool = True) -> str
2025-08-18T14:03:14.1212603Z ```
2025-08-18T14:03:14.1212737Z 
2025-08-18T14:03:14.1212897Z Return Postgres DSN from env or PG_* parts.
2025-08-18T14:03:14.1213180Z 
2025-08-18T14:03:14.1213311Z <a id="common.keepa"></a>
2025-08-18T14:03:14.1213513Z 
2025-08-18T14:03:14.1213618Z # common.keepa
2025-08-18T14:03:14.1213779Z 
2025-08-18T14:03:14.1213889Z <a id="common.llm"></a>
2025-08-18T14:03:14.1214074Z 
2025-08-18T14:03:14.1214170Z # common.llm
2025-08-18T14:03:14.1214329Z 
2025-08-18T14:03:14.1214449Z <a id="common.settings"></a>
2025-08-18T14:03:14.1214668Z 
2025-08-18T14:03:14.1214781Z # common.settings
2025-08-18T14:03:14.1214954Z 
2025-08-18T14:03:14.1215060Z <a id="common.db"></a>
2025-08-18T14:03:14.1215241Z 
2025-08-18T14:03:14.1215345Z # common.db
2025-08-18T14:03:14.1215485Z 
2025-08-18T14:03:14.1215633Z <a id="common.db.build_sqlalchemy_url"></a>
2025-08-18T14:03:14.1215917Z 
2025-08-18T14:03:14.1216036Z #### build\_sqlalchemy\_url
2025-08-18T14:03:14.1216245Z 
2025-08-18T14:03:14.1216364Z ```python
2025-08-18T14:03:14.1216637Z def build_sqlalchemy_url() -> str
2025-08-18T14:03:14.1216977Z ```
2025-08-18T14:03:14.1217107Z 
2025-08-18T14:03:14.1217267Z Return Postgres URL for SQLAlchemy engines.
2025-08-18T14:03:14.1217568Z 
2025-08-18T14:03:14.1217710Z <a id="common.db.build_asyncpg_dsn"></a>
2025-08-18T14:03:14.1217969Z 
2025-08-18T14:03:14.1218082Z #### build\_asyncpg\_dsn
2025-08-18T14:03:14.1218282Z 
2025-08-18T14:03:14.1218376Z ```python
2025-08-18T14:03:14.1218647Z def build_asyncpg_dsn() -> str
2025-08-18T14:03:14.1218975Z ```
2025-08-18T14:03:14.1219105Z 
2025-08-18T14:03:14.1219317Z Return DSN suitable for asyncpg (without driver suffix).
2025-08-18T14:03:14.1219644Z 
2025-08-18T14:03:14.1219774Z <a id="common.db.refresh_mvs"></a>
2025-08-18T14:03:14.1220022Z 
2025-08-18T14:03:14.1220126Z #### refresh\_mvs
2025-08-18T14:03:14.1220454Z 
2025-08-18T14:03:14.1220552Z ```python
2025-08-18T14:03:14.1220854Z def refresh_mvs(conn: Engine | Connection) -> None
2025-08-18T14:03:14.1221472Z ```
2025-08-18T14:03:14.1221610Z 
2025-08-18T14:03:14.1221827Z Refresh materialized views, using CONCURRENTLY when safe.
2025-08-18T14:03:14.1222223Z 
2025-08-18T14:03:14.1222348Z <a id="common.config"></a>
2025-08-18T14:03:14.1222548Z 
2025-08-18T14:03:14.1222654Z # common.config
2025-08-18T14:03:14.1222820Z 
2025-08-18T14:03:14.1222936Z <a id="common.base"></a>
2025-08-18T14:03:14.1223128Z 
2025-08-18T14:03:14.1223228Z # common.base
2025-08-18T14:03:14.1223382Z 
2025-08-18T14:03:14.1223499Z <a id="common.base.Base"></a>
2025-08-18T14:03:14.1223716Z 
2025-08-18T14:03:14.1223828Z ## Base Objects
2025-08-18T14:03:14.1223985Z 
2025-08-18T14:03:14.1224087Z ```python
2025-08-18T14:03:14.1224342Z class Base(DeclarativeBase)
2025-08-18T14:03:14.1224628Z ```
2025-08-18T14:03:14.1224757Z 
2025-08-18T14:03:14.1224882Z Base class for SQLAlchemy models.
2025-08-18T14:03:14.1225111Z 
2025-08-18T14:03:14.1225222Z <a id="repricer"></a>
2025-08-18T14:03:14.1225411Z 
2025-08-18T14:03:14.1225504Z # repricer
2025-08-18T14:03:14.1225648Z 
2025-08-18T14:03:14.1225792Z <a id="repricer.app.schemas"></a>
2025-08-18T14:03:14.1226026Z 
2025-08-18T14:03:14.1226144Z # repricer.app.schemas
2025-08-18T14:03:14.1226341Z 
2025-08-18T14:03:14.1226467Z <a id="repricer.app.deps"></a>
2025-08-18T14:03:14.1226683Z 
2025-08-18T14:03:14.1226791Z # repricer.app.deps
2025-08-18T14:03:14.1226963Z 
2025-08-18T14:03:14.1227131Z Placeholder module for Keepa / SP-API clients.
2025-08-18T14:03:14.1227432Z 
2025-08-18T14:03:14.1227562Z <a id="repricer.app.logic"></a>
2025-08-18T14:03:14.1227789Z 
2025-08-18T14:03:14.1227902Z # repricer.app.logic
2025-08-18T14:03:14.1228087Z 
2025-08-18T14:03:14.1228238Z <a id="repricer.app.logic.MIN_MARGIN"></a>
2025-08-18T14:03:14.1228506Z 
2025-08-18T14:03:14.1228603Z #### MIN\_MARGIN
2025-08-18T14:03:14.1228766Z 
2025-08-18T14:03:14.1228860Z 15 % ROI
2025-08-18T14:03:14.1228997Z 
2025-08-18T14:03:14.1229164Z <a id="repricer.app.logic.compute_price"></a>
2025-08-18T14:03:14.1229441Z 
2025-08-18T14:03:14.1229551Z #### compute\_price
2025-08-18T14:03:14.1229879Z 
2025-08-18T14:03:14.1229987Z ```python
2025-08-18T14:03:14.1230524Z def compute_price(asin: str, cost: Decimal, fees: Decimal) -> Decimal
2025-08-18T14:03:14.1230993Z ```
2025-08-18T14:03:14.1231121Z 
2025-08-18T14:03:14.1231282Z Toy algorithm: ensure 15 % ROI and round to cents.
2025-08-18T14:03:14.1231722Z Replace with real competitive logic later.
2025-08-18T14:03:14.1231986Z 
2025-08-18T14:03:14.1232120Z <a id="repricer.app.main"></a>
2025-08-18T14:03:14.1232344Z 
2025-08-18T14:03:14.1232457Z # repricer.app.main
2025-08-18T14:03:14.1232632Z 
2025-08-18T14:03:14.1232749Z <a id="repricer.app"></a>
2025-08-18T14:03:14.1232938Z 
2025-08-18T14:03:14.1233040Z # repricer.app
2025-08-18T14:03:14.1233198Z 
2025-08-18T14:03:14.1233336Z <a id="repricer.tests.test_imports"></a>
2025-08-18T14:03:14.1233594Z 
2025-08-18T14:03:14.1233721Z # repricer.tests.test\_imports
2025-08-18T14:03:14.1233937Z 
2025-08-18T14:03:14.1234070Z <a id="repricer.tests.test_smoke"></a>
2025-08-18T14:03:14.1234327Z 
2025-08-18T14:03:14.1234456Z # repricer.tests.test\_smoke
2025-08-18T14:03:14.1234658Z 
2025-08-18T14:03:14.1234774Z <a id="repricer.tests"></a>
2025-08-18T14:03:14.1234981Z 
2025-08-18T14:03:14.1235084Z # repricer.tests
2025-08-18T14:03:14.1235244Z 
2025-08-18T14:03:14.1235350Z <a id="db"></a>
2025-08-18T14:03:14.1235505Z 
2025-08-18T14:03:14.1235597Z # db
2025-08-18T14:03:14.1235723Z 
2025-08-18T14:03:14.1235846Z <a id="db.utils.views"></a>
2025-08-18T14:03:14.1236041Z 
2025-08-18T14:03:14.1236140Z # db.utils.views
2025-08-18T14:03:14.1236303Z 
2025-08-18T14:03:14.1236440Z <a id="db.utils.views.replace_view"></a>
2025-08-18T14:03:14.1236705Z 
2025-08-18T14:03:14.1236813Z #### replace\_view
2025-08-18T14:03:14.1236983Z 
2025-08-18T14:03:14.1237077Z ```python
2025-08-18T14:03:14.1237372Z def replace_view(name: str, new_sql: str) -> None
2025-08-18T14:03:14.1237742Z ```
2025-08-18T14:03:14.1237869Z 
2025-08-18T14:03:14.1238015Z Drop and recreate a SQL view atomically.
2025-08-18T14:03:14.1238444Z 
2025-08-18T14:03:14.1238560Z <a id="db.utils"></a>
2025-08-18T14:03:14.1238745Z 
2025-08-18T14:03:14.1238839Z # db.utils
2025-08-18T14:03:14.1238978Z 
2025-08-18T14:03:14.1239107Z <a id="price_importer"></a>
2025-08-18T14:03:14.1239314Z 
2025-08-18T14:03:14.1239419Z # price\_importer
2025-08-18T14:03:14.1239580Z 
2025-08-18T14:03:14.1239751Z <a id="price_importer.services_common.dsn"></a>
2025-08-18T14:03:14.1240039Z 
2025-08-18T14:03:14.1240329Z # price\_importer.services\_common.dsn
2025-08-18T14:03:14.1240599Z 
2025-08-18T14:03:14.1240790Z <a id="price_importer.services_common.dsn.build_dsn"></a>
2025-08-18T14:03:14.1241104Z 
2025-08-18T14:03:14.1241213Z #### build\_dsn
2025-08-18T14:03:14.1241369Z 
2025-08-18T14:03:14.1241467Z ```python
2025-08-18T14:03:14.1241738Z def build_dsn(sync: bool = True) -> str
2025-08-18T14:03:14.1242076Z ```
2025-08-18T14:03:14.1242201Z 
2025-08-18T14:03:14.1242309Z Return safe DSN.
2025-08-18T14:03:14.1242466Z 
2025-08-18T14:03:14.1242940Z sync=True → SQLAlchemy (+psycopg) else plain asyncpg.
2025-08-18T14:03:14.1243268Z 
2025-08-18T14:03:14.1243451Z <a id="price_importer.services_common.models_vendor"></a>
2025-08-18T14:03:14.1243766Z 
2025-08-18T14:03:14.1243939Z # price\_importer.services\_common.models\_vendor
2025-08-18T14:03:14.1244225Z 
2025-08-18T14:03:14.1244384Z <a id="price_importer.services_common.db_url"></a>
2025-08-18T14:03:14.1244672Z 
2025-08-18T14:03:14.1244811Z # price\_importer.services\_common.db\_url
2025-08-18T14:03:14.1245068Z 
2025-08-18T14:03:14.1245265Z <a id="price_importer.services_common.db_url.build_url"></a>
2025-08-18T14:03:14.1245601Z 
2025-08-18T14:03:14.1245701Z #### build\_url
2025-08-18T14:03:14.1245851Z 
2025-08-18T14:03:14.1245954Z ```python
2025-08-18T14:03:14.1246215Z def build_url(async_: bool = True) -> str
2025-08-18T14:03:14.1246565Z ```
2025-08-18T14:03:14.1246690Z 
2025-08-18T14:03:14.1246838Z Return Postgres DSN from env or PG_* parts.
2025-08-18T14:03:14.1247103Z 
2025-08-18T14:03:14.1247263Z <a id="price_importer.services_common.keepa"></a>
2025-08-18T14:03:14.1247748Z 
2025-08-18T14:03:14.1247890Z # price\_importer.services\_common.keepa
2025-08-18T14:03:14.1248163Z 
2025-08-18T14:03:14.1248324Z <a id="price_importer.services_common.llm"></a>
2025-08-18T14:03:14.1248604Z 
2025-08-18T14:03:14.1248747Z # price\_importer.services\_common.llm
2025-08-18T14:03:14.1249005Z 
2025-08-18T14:03:14.1249182Z <a id="price_importer.services_common.settings"></a>
2025-08-18T14:03:14.1249487Z 
2025-08-18T14:03:14.1249633Z # price\_importer.services\_common.settings
2025-08-18T14:03:14.1249897Z 
2025-08-18T14:03:14.1250047Z <a id="price_importer.services_common.db"></a>
2025-08-18T14:03:14.1250479Z 
2025-08-18T14:03:14.1250621Z # price\_importer.services\_common.db
2025-08-18T14:03:14.1250866Z 
2025-08-18T14:03:14.1251108Z <a id="price_importer.services_common.db.build_sqlalchemy_url"></a>
2025-08-18T14:03:14.1251479Z 
2025-08-18T14:03:14.1251595Z #### build\_sqlalchemy\_url
2025-08-18T14:03:14.1251816Z 
2025-08-18T14:03:14.1251913Z ```python
2025-08-18T14:03:14.1252176Z def build_sqlalchemy_url() -> str
2025-08-18T14:03:14.1252504Z ```
2025-08-18T14:03:14.1252629Z 
2025-08-18T14:03:14.1252785Z Return Postgres URL for SQLAlchemy engines.
2025-08-18T14:03:14.1253061Z 
2025-08-18T14:03:14.1253275Z <a id="price_importer.services_common.db.build_asyncpg_dsn"></a>
2025-08-18T14:03:14.1253649Z 
2025-08-18T14:03:14.1253762Z #### build\_asyncpg\_dsn
2025-08-18T14:03:14.1253950Z 
2025-08-18T14:03:14.1254048Z ```python
2025-08-18T14:03:14.1254314Z def build_asyncpg_dsn() -> str
2025-08-18T14:03:14.1254613Z ```
2025-08-18T14:03:14.1254752Z 
2025-08-18T14:03:14.1254947Z Return DSN suitable for asyncpg (without driver suffix).
2025-08-18T14:03:14.1255265Z 
2025-08-18T14:03:14.1255468Z <a id="price_importer.services_common.db.refresh_mvs"></a>
2025-08-18T14:03:14.1255794Z 
2025-08-18T14:03:14.1255896Z #### refresh\_mvs
2025-08-18T14:03:14.1256066Z 
2025-08-18T14:03:14.1256165Z ```python
2025-08-18T14:03:14.1256471Z def refresh_mvs(conn: Engine | Connection) -> None
2025-08-18T14:03:14.1257050Z ```
2025-08-18T14:03:14.1257179Z 
2025-08-18T14:03:14.1257395Z Refresh materialized views, using CONCURRENTLY when safe.
2025-08-18T14:03:14.1257728Z 
2025-08-18T14:03:14.1257874Z <a id="price_importer.services_common"></a>
2025-08-18T14:03:14.1258135Z 
2025-08-18T14:03:14.1258278Z # price\_importer.services\_common
2025-08-18T14:03:14.1258520Z 
2025-08-18T14:03:14.1258675Z <a id="price_importer.services_common.base"></a>
2025-08-18T14:03:14.1258961Z 
2025-08-18T14:03:14.1259092Z # price\_importer.services\_common.base
2025-08-18T14:03:14.1259341Z 
2025-08-18T14:03:14.1259486Z <a id="price_importer.normaliser"></a>
2025-08-18T14:03:14.1259739Z 
2025-08-18T14:03:14.1259862Z # price\_importer.normaliser
2025-08-18T14:03:14.1260075Z 
2025-08-18T14:03:14.1260434Z <a id="price_importer.common.models_vendor"></a>
2025-08-18T14:03:14.1260722Z 
2025-08-18T14:03:14.1260857Z # price\_importer.common.models\_vendor
2025-08-18T14:03:14.1261119Z 
2025-08-18T14:03:14.1261256Z <a id="price_importer.common.db_url"></a>
2025-08-18T14:03:14.1261525Z 
2025-08-18T14:03:14.1261664Z # price\_importer.common.db\_url
2025-08-18T14:03:14.1261888Z 
2025-08-18T14:03:14.1262046Z <a id="price_importer.common.db_url.make_dsn"></a>
2025-08-18T14:03:14.1262327Z 
2025-08-18T14:03:14.1262437Z #### make\_dsn
2025-08-18T14:03:14.1262585Z 
2025-08-18T14:03:14.1262685Z ```python
2025-08-18T14:03:14.1262951Z def make_dsn(async_: bool = False) -> str
2025-08-18T14:03:14.1263291Z ```
2025-08-18T14:03:14.1263453Z 
2025-08-18T14:03:14.1263633Z Return DSN built from either PG_* or POSTGRES_* vars.
2025-08-18T14:03:14.1263943Z 
2025-08-18T14:03:14.1264109Z <a id="price_importer.common.db_url.build_url"></a>
2025-08-18T14:03:14.1264408Z 
2025-08-18T14:03:14.1264511Z #### build\_url
2025-08-18T14:03:14.1264660Z 
2025-08-18T14:03:14.1264758Z ```python
2025-08-18T14:03:14.1265037Z def build_url(async_: bool = False) -> str
2025-08-18T14:03:14.1265393Z ```
2025-08-18T14:03:14.1265518Z 
2025-08-18T14:03:14.1265721Z Return Postgres DSN built from environment variables.
2025-08-18T14:03:14.1266218Z 
2025-08-18T14:03:14.1266352Z <a id="price_importer.common"></a>
2025-08-18T14:03:14.1266603Z 
2025-08-18T14:03:14.1266726Z # price\_importer.common
2025-08-18T14:03:14.1266931Z 
2025-08-18T14:03:14.1267072Z <a id="price_importer.common.base"></a>
2025-08-18T14:03:14.1267317Z 
2025-08-18T14:03:14.1267437Z # price\_importer.common.base
2025-08-18T14:03:14.1267646Z 
2025-08-18T14:03:14.1267798Z <a id="price_importer.tests.conftest"></a>
2025-08-18T14:03:14.1268061Z 
2025-08-18T14:03:14.1268198Z # price\_importer.tests.conftest
2025-08-18T14:03:14.1268435Z 
2025-08-18T14:03:14.1268588Z <a id="price_importer.tests.test_reader"></a>
2025-08-18T14:03:14.1268867Z 
2025-08-18T14:03:14.1269004Z # price\_importer.tests.test\_reader
2025-08-18T14:03:14.1269266Z 
2025-08-18T14:03:14.1269426Z <a id="price_importer.tests.test_imports"></a>
2025-08-18T14:03:14.1269708Z 
2025-08-18T14:03:14.1269852Z # price\_importer.tests.test\_imports
2025-08-18T14:03:14.1270116Z 
2025-08-18T14:03:14.1270431Z <a id="price_importer.tests.test_smoke"></a>
2025-08-18T14:03:14.1270732Z 
2025-08-18T14:03:14.1270866Z # price\_importer.tests.test\_smoke
2025-08-18T14:03:14.1271131Z 
2025-08-18T14:03:14.1271314Z <a id="price_importer.tests.test_normaliser"></a>
2025-08-18T14:03:14.1271620Z 
2025-08-18T14:03:14.1271775Z # price\_importer.tests.test\_normaliser
2025-08-18T14:03:14.1272061Z 
2025-08-18T14:03:14.1272192Z <a id="price_importer.tests"></a>
2025-08-18T14:03:14.1272430Z 
2025-08-18T14:03:14.1272547Z # price\_importer.tests
2025-08-18T14:03:14.1272753Z 
2025-08-18T14:03:14.1272889Z <a id="price_importer.reader"></a>
2025-08-18T14:03:14.1273127Z 
2025-08-18T14:03:14.1273252Z # price\_importer.reader
2025-08-18T14:03:14.1273458Z 
2025-08-18T14:03:14.1273597Z <a id="price_importer.repository"></a>
2025-08-18T14:03:14.1273862Z 
2025-08-18T14:03:14.1274001Z # price\_importer.repository
2025-08-18T14:03:14.1274217Z 
2025-08-18T14:03:14.1274347Z <a id="price_importer.import"></a>
2025-08-18T14:03:14.1274766Z 
2025-08-18T14:03:14.1274897Z # price\_importer.import
2025-08-18T14:03:14.1275105Z 
2025-08-18T14:03:14.1275218Z <a id="fees_h10"></a>
2025-08-18T14:03:14.1275401Z 
2025-08-18T14:03:14.1275503Z # fees\_h10
2025-08-18T14:03:14.1275647Z 
2025-08-18T14:03:14.1275776Z <a id="fees_h10.worker"></a>
2025-08-18T14:03:14.1275983Z 
2025-08-18T14:03:14.1276084Z # fees\_h10.worker
2025-08-18T14:03:14.1276257Z 
2025-08-18T14:03:14.1276403Z <a id="fees_h10.worker.list_active_asins"></a>
2025-08-18T14:03:14.1276680Z 
2025-08-18T14:03:14.1276791Z #### list\_active\_asins
2025-08-18T14:03:14.1277041Z 
2025-08-18T14:03:14.1277147Z ```python
2025-08-18T14:03:14.1277417Z def list_active_asins() -> list[str]
2025-08-18T14:03:14.1277745Z ```
2025-08-18T14:03:14.1277868Z 
2025-08-18T14:03:14.1278052Z Return known ASINs or an empty list if unavailable.
2025-08-18T14:03:14.1278361Z 
2025-08-18T14:03:14.1278494Z <a id="fees_h10.tests.test_smoke"></a>
2025-08-18T14:03:14.1278749Z 
2025-08-18T14:03:14.1278883Z # fees\_h10.tests.test\_smoke
2025-08-18T14:03:14.1279114Z 
2025-08-18T14:03:14.1279237Z <a id="fees_h10.tests"></a>
2025-08-18T14:03:14.1279446Z 
2025-08-18T14:03:14.1279547Z # fees\_h10.tests
2025-08-18T14:03:14.1279710Z 
2025-08-18T14:03:14.1279837Z <a id="fees_h10.client"></a>
2025-08-18T14:03:14.1280049Z 
2025-08-18T14:03:14.1280330Z # fees\_h10.client
2025-08-18T14:03:14.1280517Z 
2025-08-18T14:03:14.1280647Z <a id="fees_h10.repository"></a>
2025-08-18T14:03:14.1280881Z 
2025-08-18T14:03:14.1281003Z # fees\_h10.repository
2025-08-18T14:03:14.1281191Z 
2025-08-18T14:03:14.1281303Z <a id="emailer"></a>
2025-08-18T14:03:14.1281485Z 
2025-08-18T14:03:14.1281593Z # emailer
2025-08-18T14:03:14.1281733Z 
2025-08-18T14:03:14.1281894Z <a id="emailer.tests.test_import_emailer"></a>
2025-08-18T14:03:14.1282190Z 
2025-08-18T14:03:14.1282327Z # emailer.tests.test\_import\_emailer
2025-08-18T14:03:14.1282588Z 
2025-08-18T14:03:14.1282728Z <a id="emailer.tests.test_smoke"></a>
2025-08-18T14:03:14.1282992Z 
2025-08-18T14:03:14.1283129Z # emailer.tests.test\_smoke
2025-08-18T14:03:14.1283518Z 
2025-08-18T14:03:14.1283645Z <a id="emailer.tests"></a>
2025-08-18T14:03:14.1283846Z 
2025-08-18T14:03:14.1283948Z # emailer.tests
2025-08-18T14:03:14.1284113Z 
2025-08-18T14:03:14.1284248Z <a id="emailer.generate_body"></a>
2025-08-18T14:03:14.1284486Z 
2025-08-18T14:03:14.1284605Z # emailer.generate\_body
2025-08-18T14:03:14.1284811Z 
2025-08-18T14:03:14.1284921Z <a id="llm_server"></a>
2025-08-18T14:03:14.1285104Z 
2025-08-18T14:03:14.1285211Z # llm\_server
2025-08-18T14:03:14.1285366Z 
2025-08-18T14:03:14.1285484Z <a id="llm_server.app"></a>
2025-08-18T14:03:14.1285704Z 
2025-08-18T14:03:14.1285811Z # llm\_server.app
2025-08-18T14:03:14.1285980Z 
