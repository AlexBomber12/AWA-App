2025-08-19T13:58:04.2736677Z ##[group]Run pytest -q --cov=services
2025-08-19T13:58:04.2737259Z [36;1mpytest -q --cov=services[0m
2025-08-19T13:58:04.2789014Z shell: /usr/bin/bash -e {0}
2025-08-19T13:58:04.2789461Z env:
2025-08-19T13:58:04.2789708Z   REDIS_URL: redis://localhost:6379/0
2025-08-19T13:58:04.2790007Z   RATE_LIMIT_DEFAULT: 100/minute
2025-08-19T13:58:04.2790268Z   TRUST_X_FORWARDED: 1
2025-08-19T13:58:04.2790478Z   PG_USER: postgres
2025-08-19T13:58:04.2790687Z   PG_PASSWORD: pass
2025-08-19T13:58:04.2790887Z   PG_DATABASE: awa
2025-08-19T13:58:04.2791089Z   PG_HOST: localhost
2025-08-19T13:58:04.2791293Z   PG_PORT: 5432
2025-08-19T13:58:04.2791763Z   PG_SYNC_DSN: ***localhost:5432/awa
2025-08-19T13:58:04.2792408Z   PG_ASYNC_DSN: ***localhost:5432/awa
2025-08-19T13:58:04.2792941Z   DATABASE_URL: ***localhost:5432/awa
2025-08-19T13:58:04.2793448Z   DATA_DIR: /home/runner/work/_temp/awa-data
2025-08-19T13:58:04.2793861Z   ENABLE_LIVE: 0
2025-08-19T13:58:04.2794197Z   TESTING: 1
2025-08-19T13:58:04.2794537Z   pythonLocation: /opt/hostedtoolcache/Python/3.12.11/x64
2025-08-19T13:58:04.2795164Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.12.11/x64/lib/pkgconfig
2025-08-19T13:58:04.2795810Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.12.11/x64
2025-08-19T13:58:04.2820984Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.12.11/x64
2025-08-19T13:58:04.2821539Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.12.11/x64
2025-08-19T13:58:04.2822281Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.12.11/x64/lib
2025-08-19T13:58:04.2822899Z   POSTGRES_USER: postgres
2025-08-19T13:58:04.2823165Z   POSTGRES_PASSWORD: pass
2025-08-19T13:58:04.2823402Z   POSTGRES_DB: awa
2025-08-19T13:58:04.2823616Z   LLM_PROVIDER: lan
2025-08-19T13:58:04.2823964Z   LLM_BASE_URL: http://localhost:8000
2025-08-19T13:58:04.2824282Z ##[endgroup]
2025-08-19T13:58:38.0183880Z ........s.............................sssssss........................... [ 43%]
2025-08-19T13:59:11.1713730Z ...................................................F.................... [ 86%]
2025-08-19T13:59:11.8151020Z ......................                                                   [100%]
2025-08-19T13:59:11.8151685Z =================================== FAILURES ===================================
2025-08-19T13:59:11.8152497Z ___________________________ test_roi_basic_auth_good ___________________________
2025-08-19T13:59:11.8153083Z 
2025-08-19T13:59:11.8153483Z monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f657199b170>
2025-08-19T13:59:11.8153878Z 
2025-08-19T13:59:11.8154062Z     def test_roi_basic_auth_good(monkeypatch):
2025-08-19T13:59:11.8154488Z         os.environ["API_BASIC_USER"] = "u"
2025-08-19T13:59:11.8154898Z         os.environ["API_BASIC_PASS"] = "p"
2025-08-19T13:59:11.8155308Z         with _client() as client:
2025-08-19T13:59:11.8155976Z >           r = client.get("/roi", headers=_auth_headers("u", "p"))
2025-08-19T13:59:11.8156484Z                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8156742Z 
2025-08-19T13:59:11.8157010Z services/api/tests/test_roi_basic_auth.py:33: 
2025-08-19T13:59:11.8157586Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-08-19T13:59:11.8158508Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/testclient.py:479: in get
2025-08-19T13:59:11.8159220Z     return super().get(
2025-08-19T13:59:11.8160184Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/httpx/_client.py:1053: in get
2025-08-19T13:59:11.8160863Z     return self.request(
2025-08-19T13:59:11.8161703Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/testclient.py:451: in request
2025-08-19T13:59:11.8162434Z     return super().request(
2025-08-19T13:59:11.8163503Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/httpx/_client.py:825: in request
2025-08-19T13:59:11.8164404Z     return self.send(request, auth=auth, follow_redirects=follow_redirects)
2025-08-19T13:59:11.8165002Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8166069Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/utils.py:1816: in runner
2025-08-19T13:59:11.8166825Z     return sentry_patched_function(*args, **kwargs)
2025-08-19T13:59:11.8167141Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8167764Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/httpx.py:86: in send
2025-08-19T13:59:11.8168313Z     rv = real_send(self, request, **kwargs)
2025-08-19T13:59:11.8168594Z          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8169133Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/httpx/_client.py:914: in send
2025-08-19T13:59:11.8169900Z     response = self._send_handling_auth(
2025-08-19T13:59:11.8170530Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/httpx/_client.py:942: in _send_handling_auth
2025-08-19T13:59:11.8171082Z     response = self._send_handling_redirects(
2025-08-19T13:59:11.8171745Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/httpx/_client.py:979: in _send_handling_redirects
2025-08-19T13:59:11.8172330Z     response = self._send_single_request(request)
2025-08-19T13:59:11.8172642Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8173264Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/httpx/_client.py:1014: in _send_single_request
2025-08-19T13:59:11.8173833Z     response = transport.handle_request(request)
2025-08-19T13:59:11.8174138Z                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8174766Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/testclient.py:354: in handle_request
2025-08-19T13:59:11.8175281Z     raise exc
2025-08-19T13:59:11.8175848Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/testclient.py:351: in handle_request
2025-08-19T13:59:11.8176419Z     portal.call(self.app, scope, receive, send)
2025-08-19T13:59:11.8177015Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/anyio/from_thread.py:291: in call
2025-08-19T13:59:11.8177598Z     return cast(T_Retval, self.start_task_soon(func, *args).result())
2025-08-19T13:59:11.8177973Z                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8178526Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/concurrent/futures/_base.py:456: in result
2025-08-19T13:59:11.8178999Z     return self.__get_result()
2025-08-19T13:59:11.8179355Z            ^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8179900Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
2025-08-19T13:59:11.8180381Z     raise self._exception
2025-08-19T13:59:11.8180945Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/anyio/from_thread.py:222: in _call_func
2025-08-19T13:59:11.8181465Z     retval = await retval_or_awaitable
2025-08-19T13:59:11.8181738Z              ^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8182339Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
2025-08-19T13:59:11.8182884Z     await super().__call__(scope, receive, send)
2025-08-19T13:59:11.8183644Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py:408: in _sentry_patched_asgi_app
2025-08-19T13:59:11.8184305Z     return await middleware(scope, receive, send)
2025-08-19T13:59:11.8184612Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8185254Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/asgi.py:179: in _run_asgi3
2025-08-19T13:59:11.8186038Z     return await self._run_app(scope, receive, send, asgi_version=3)
2025-08-19T13:59:11.8186417Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8187059Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/asgi.py:268: in _run_app
2025-08-19T13:59:11.8187703Z     raise exc from None
2025-08-19T13:59:11.8188296Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/asgi.py:263: in _run_app
2025-08-19T13:59:11.8188816Z     return await self.app(
2025-08-19T13:59:11.8189504Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/applications.py:113: in __call__
2025-08-19T13:59:11.8190083Z     await self.middleware_stack(scope, receive, send)
2025-08-19T13:59:11.8190832Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py:199: in _create_span_call
2025-08-19T13:59:11.8191542Z     return await old_call(app, scope, new_receive, new_send, **kwargs)
2025-08-19T13:59:11.8191922Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8192565Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/errors.py:186: in __call__
2025-08-19T13:59:11.8193081Z     raise exc
2025-08-19T13:59:11.8193642Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/errors.py:164: in __call__
2025-08-19T13:59:11.8194196Z     await self.app(scope, receive, _send)
2025-08-19T13:59:11.8194917Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py:199: in _create_span_call
2025-08-19T13:59:11.8195609Z     return await old_call(app, scope, new_receive, new_send, **kwargs)
2025-08-19T13:59:11.8195977Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8196600Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/cors.py:85: in __call__
2025-08-19T13:59:11.8197147Z     await self.app(scope, receive, send)
2025-08-19T13:59:11.8197849Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py:199: in _create_span_call
2025-08-19T13:59:11.8198536Z     return await old_call(app, scope, new_receive, new_send, **kwargs)
2025-08-19T13:59:11.8198905Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8199677Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/asgi_correlation_id/middleware.py:90: in __call__
2025-08-19T13:59:11.8200292Z     await self.app(scope, receive, handle_outgoing_request)
2025-08-19T13:59:11.8201130Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py:297: in _sentry_exceptionmiddleware_call
2025-08-19T13:59:11.8201812Z     await old_call(self, scope, receive, send)
2025-08-19T13:59:11.8202527Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py:199: in _create_span_call
2025-08-19T13:59:11.8203218Z     return await old_call(app, scope, new_receive, new_send, **kwargs)
2025-08-19T13:59:11.8203591Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8204251Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/exceptions.py:63: in __call__
2025-08-19T13:59:11.8204924Z     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
2025-08-19T13:59:11.8205680Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-08-19T13:59:11.8206204Z     raise exc
2025-08-19T13:59:11.8206773Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-08-19T13:59:11.8207327Z     await app(scope, receive, sender)
2025-08-19T13:59:11.8207902Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py:716: in __call__
2025-08-19T13:59:11.8208583Z     await self.middleware_stack(scope, receive, send)
2025-08-19T13:59:11.8209185Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py:736: in app
2025-08-19T13:59:11.8210060Z     await route.handle(scope, receive, send)
2025-08-19T13:59:11.8210664Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py:290: in handle
2025-08-19T13:59:11.8211225Z     await self.app(scope, receive, send)
2025-08-19T13:59:11.8211795Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py:78: in app
2025-08-19T13:59:11.8212396Z     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
2025-08-19T13:59:11.8213151Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
2025-08-19T13:59:11.8213672Z     raise exc
2025-08-19T13:59:11.8214257Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py:42: in wrapped_app
2025-08-19T13:59:11.8214814Z     await app(scope, receive, sender)
2025-08-19T13:59:11.8215370Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py:75: in app
2025-08-19T13:59:11.8215859Z     response = await f(request)
2025-08-19T13:59:11.8216108Z                ^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8216759Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/fastapi.py:137: in _sentry_app
2025-08-19T13:59:11.8217343Z     return await old_app(*args, **kwargs)
2025-08-19T13:59:11.8217618Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8218163Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/fastapi/routing.py:302: in app
2025-08-19T13:59:11.8218675Z     raw_response = await run_endpoint_function(
2025-08-19T13:59:11.8219446Z /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/fastapi/routing.py:213: in run_endpoint_function
2025-08-19T13:59:11.8220016Z     return await dependant.call(**values)
2025-08-19T13:59:11.8220289Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8220580Z services/api/routes/roi.py:40: in roi
2025-08-19T13:59:11.8221006Z     rows = await roi_repository.fetch_roi_rows(session, roi_min, vendor, category)
2025-08-19T13:59:11.8221442Z            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
2025-08-19T13:59:11.8221826Z _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
2025-08-19T13:59:11.8222040Z 
2025-08-19T13:59:11.8222306Z session = <test_cors._get_app.<locals>.FakeSession object at 0x7f6571a56cf0>
2025-08-19T13:59:11.8222737Z roi_min = 0.0, vendor = None, category = None
2025-08-19T13:59:11.8222930Z 
2025-08-19T13:59:11.8223024Z     async def fetch_roi_rows(
2025-08-19T13:59:11.8223428Z         session: AsyncSession, roi_min: float, vendor: int | None, category: str | None
2025-08-19T13:59:11.8223828Z     ) -> list[RowMapping]:
2025-08-19T13:59:11.8224109Z >       result = await session.execute(
2025-08-19T13:59:11.8224491Z             ROI_SQL, {"roi_min": roi_min, "vendor": vendor, "category": category}
2025-08-19T13:59:11.8224810Z         )
2025-08-19T13:59:11.8225312Z E       TypeError: _get_app.<locals>.FakeSession.execute() takes 2 positional arguments but 3 were given
2025-08-19T13:59:11.8225688Z 
2025-08-19T13:59:11.8225853Z services/api/roi_repository.py:45: TypeError
2025-08-19T13:59:11.8226286Z ------------------------------ Captured log call -------------------------------
2025-08-19T13:59:11.8295963Z ERROR    services.api.errors:errors.py:57 {"event": "unhandled_error", "request_id": "739dff582ef945baa40773fe9c822d59", "level": "error", "timestamp": "2025-08-19T13:59:09.451259Z", "exception": [{"exc_type": "TypeError", "exc_value": "_get_app.<locals>.FakeSession.execute() takes 2 positional arguments but 3 were given", "syntax_error": null, "is_cause": false, "frames": [{"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/errors.py", "lineno": 164, "name": "__call__", "line": "", "locals": {"self": "<starlette.middleware.errors.ServerErrorMiddleware object at 0x7f6571b58260>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "_send": "<function ServerErrorMiddleware.__call__.<locals>._send at 0x7f65719d1940>", "exc": "\"TypeError('_get_app.<locals>.FakeSession.execute() takes 2 positional arguments \"+18", "request": "<starlette.requests.Request object at 0x7f6571b43ce0>", "response_started": "False"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py", "lineno": 199, "name": "_create_span_call", "line": "", "locals": {"app": "<starlette.middleware.cors.CORSMiddleware object at 0x7f6571b58290>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "<function ServerErrorMiddleware.__call__.<locals>._send at 0x7f65719d1940>", "kwargs": "{}", "integration": "'<sentry_sdk.integrations.starlette.StarletteIntegration object at 0x7f6571b597f0'+1", "name": "None", "source": "route", "middleware_span": "\"<Span(op='middleware.starlette', description:'CORSMiddleware', trace_id='6a91c22\"+136", "_sentry_receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "receive_name": "_sentry_receive", "receive_patched": "True", "new_receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "_sentry_send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "send_name": "_send", "send_patched": "False", "new_send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "middleware_name": "CORSMiddleware", "old_call": "<function CORSMiddleware.__call__ at 0x7f6574f2a8e0>"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/cors.py", "lineno": 85, "name": "__call__", "line": "", "locals": {"self": "<starlette.middleware.cors.CORSMiddleware object at 0x7f6571b58290>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "method": "GET", "headers": "\"Headers({'host': 'testserver', 'accept': '*/*', 'accept-encoding': 'gzip, deflat\"+91", "origin": "None"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py", "lineno": 199, "name": "_create_span_call", "line": "", "locals": {"app": "'CorrelationIdMiddleware(app=<starlette.middleware.exceptions.ExceptionMiddleware'+286", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "kwargs": "{}", "integration": "'<sentry_sdk.integrations.starlette.StarletteIntegration object at 0x7f6571b597f0'+1", "name": "None", "source": "route", "middleware_span": "\"<Span(op='middleware.starlette', description:'CorrelationIdMiddleware', trace_id\"+145", "_sentry_receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "receive_name": "_sentry_receive", "receive_patched": "True", "new_receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "_sentry_send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "send_name": "_sentry_send", "send_patched": "True", "new_send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "middleware_name": "CorrelationIdMiddleware", "old_call": "<function CorrelationIdMiddleware.__call__ at 0x7f6574f2a200>"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/asgi_correlation_id/middleware.py", "lineno": 90, "name": "__call__", "line": "", "locals": {"self": "'CorrelationIdMiddleware(app=<starlette.middleware.exceptions.ExceptionMiddleware'+286", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "headers": "\"MutableHeaders({'host': 'testserver', 'accept': '*/*', 'accept-encoding': 'gzip,\"+150", "header_value": "None", "validation_failed": "False", "id_value": "739dff582ef945baa40773fe9c822d59", "handle_outgoing_request": "'<function CorrelationIdMiddleware.__call__.<locals>.handle_outgoing_request at 0'+14"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py", "lineno": 297, "name": "_sentry_exceptionmiddleware_call", "line": "", "locals": {"self": "<starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f65719b5a90>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function CorrelationIdMiddleware.__call__.<locals>.handle_outgoing_request at 0'+14", "old_call": "'<function _enable_span_for_middleware.<locals>._create_span_call at 0x7f6571d5c9'+3"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/starlette.py", "lineno": 199, "name": "_create_span_call", "line": "", "locals": {"app": "<starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f65719b5a90>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function CorrelationIdMiddleware.__call__.<locals>.handle_outgoing_request at 0'+14", "kwargs": "{}", "integration": "'<sentry_sdk.integrations.starlette.StarletteIntegration object at 0x7f6571b597f0'+1", "name": "None", "source": "route", "middleware_span": "\"<Span(op='middleware.starlette', description:'ExceptionMiddleware', trace_id='6a\"+141", "_sentry_receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "receive_name": "_sentry_receive", "receive_patched": "True", "new_receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "_sentry_send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "send_name": "handle_outgoing_request", "send_patched": "False", "new_send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "middleware_name": "ExceptionMiddleware", "old_call": "<function ExceptionMiddleware.__call__ at 0x7f65847c2c00>"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/middleware/exceptions.py", "lineno": 63, "name": "__call__", "line": "", "locals": {"self": "<starlette.middleware.exceptions.ExceptionMiddleware object at 0x7f65719b5a90>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "conn": "<starlette.requests.Request object at 0x7f6571a61790>"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py", "lineno": 53, "name": "wrapped_app", "line": "", "locals": {"scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "sender": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "handler": "None", "response_started": "False", "app": "<fastapi.routing.APIRouter object at 0x7f6571b5b440>", "conn": "<starlette.requests.Request object at 0x7f6571a61790>", "exception_handlers": "\"{<class 'starlette.exceptions.HTTPException'>: <function patch_exception_middlew\"+822", "status_handlers": "{}"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py", "lineno": 42, "name": "wrapped_app", "line": "", "locals": {"scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+25", "sender": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "handler": "None", "response_started": "False", "app": "<fastapi.routing.APIRouter object at 0x7f6571b5b440>", "conn": "<starlette.requests.Request object at 0x7f6571a61790>", "exception_handlers": "\"{<class 'starlette.exceptions.HTTPException'>: <function patch_exception_middlew\"+822", "status_handlers": "{}"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py", "lineno": 716, "name": "__call__", "line": "", "locals": {"self": "<fastapi.routing.APIRouter object at 0x7f6571b5b440>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py", "lineno": 736, "name": "app", "line": "", "locals": {"self": "<fastapi.routing.APIRouter object at 0x7f6571b5b440>", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "partial": "None", "route": "APIRoute(path='/roi', name='roi', methods=['GET'])", "match": "<Match.FULL: 2>", "child_scope": "\"{'endpoint': <function roi at 0x7f65746e68e0>, 'path_params': {}, 'route': APIRo\"+46"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py", "lineno": 290, "name": "handle", "line": "", "locals": {"self": "APIRoute(path='/roi', name='roi', methods=['GET'])", "scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py", "lineno": 78, "name": "app", "line": "", "locals": {"scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "app": "<function request_response.<locals>.app.<locals>.app at 0x7f65719d18a0>", "request": "<starlette.requests.Request object at 0x7f6571a61970>", "f": "'<function patch_get_request_handler.<locals>._sentry_get_request_handler.<locals'+32"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py", "lineno": 53, "name": "wrapped_app", "line": "", "locals": {"scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "sender": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "handler": "None", "response_started": "False", "app": "<function request_response.<locals>.app.<locals>.app at 0x7f65719d18a0>", "conn": "<starlette.requests.Request object at 0x7f6571a61970>", "exception_handlers": "\"{<class 'starlette.exceptions.HTTPException'>: <function patch_exception_middlew\"+822", "status_handlers": "{}"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/_exception_handler.py", "lineno": 42, "name": "wrapped_app", "line": "", "locals": {"scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "sender": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "handler": "None", "response_started": "False", "app": "<function request_response.<locals>.app.<locals>.app at 0x7f65719d18a0>", "conn": "<starlette.requests.Request object at 0x7f6571a61970>", "exception_handlers": "\"{<class 'starlette.exceptions.HTTPException'>: <function patch_exception_middlew\"+822", "status_handlers": "{}"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/starlette/routing.py", "lineno": 75, "name": "app", "line": "", "locals": {"scope": "\"{'type': 'http', 'http_version': '1.1', 'method': 'GET', 'path': '/roi', 'raw_pa\"+1639", "receive": "'<function _enable_span_for_middleware.<locals>._create_span_call.<locals>._sentr'+28", "send": "'<function wrap_app_handling_exceptions.<locals>.wrapped_app.<locals>.sender at 0'+14", "f": "'<function patch_get_request_handler.<locals>._sentry_get_request_handler.<locals'+32", "request": "<starlette.requests.Request object at 0x7f6571a61970>"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/sentry_sdk/integrations/fastapi.py", "lineno": 137, "name": "_sentry_app", "line": "", "locals": {"args": "(<starlette.requests.Request object at 0x7f6571a61970>,)", "kwargs": "{}", "integration": "<sentry_sdk.integrations.fastapi.FastApiIntegration object at 0x7f65717d8950>", "request": "<starlette.requests.Request object at 0x7f6571a61970>", "sentry_scope": "<Scope id=0x7f6571a2a420 name=fastapi type=ScopeType.ISOLATION>", "extractor": "'<sentry_sdk.integrations.starlette.StarletteRequestExtractor object at 0x7f6571a'+6", "_make_request_event_processor": "'<function patch_get_request_handler.<locals>._sentry_get_request_handler.<locals'+71", "info": "{}", "old_app": "<function get_request_handler.<locals>.app at 0x7f65719cd3a0>"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/fastapi/routing.py", "lineno": 302, "name": "app", "line": "", "locals": {"request": "<starlette.requests.Request object at 0x7f6571a61970>", "response": "None", "file_stack": "<contextlib.AsyncExitStack object at 0x7f6571a61b50>", "body": "None", "errors": "[]", "async_exit_stack": "<contextlib.AsyncExitStack object at 0x7f6571a61b80>", "solved_result": "\"SolvedDependency(values={'session': <test_cors._get_app.<locals>.FakeSession obj\"+562", "actual_response_class": "<class 'starlette.responses.JSONResponse'>", "body_field": "None", "dependant": "\"Dependant(path_params=[], query_params=[ModelField(field_info=Query(0), name='ro\"+2748", "dependency_overrides_provider": "<fastapi.applications.FastAPI object at 0x7f6571a8ce00>", "embed_body_fields": "False", "is_body_form": "None", "is_coroutine": "True", "response_field": "None", "response_model_by_alias": "True", "response_model_exclude": "None", "response_model_exclude_defaults": "False", "response_model_exclude_none": "False", "response_model_exclude_unset": "False", "response_model_include": "None", "status_code": "None"}}, {"filename": "/opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/fastapi/routing.py", "lineno": 213, "name": "run_endpoint_function", "line": "", "locals": {"dependant": "\"Dependant(path_params=[], query_params=[ModelField(field_info=Query(0), name='ro\"+2748", "values": "\"{'session': <test_cors._get_app.<locals>.FakeSession object at 0x7f6571a56cf0>, \"+49", "is_coroutine": "True"}}, {"filename": "/home/runner/work/AWA-App/AWA-App/services/api/routes/roi.py", "lineno": 40, "name": "roi", "line": "", "locals": {"roi_min": "0.0", "vendor": "None", "category": "None", "session": "<test_cors._get_app.<locals>.FakeSession object at 0x7f6571a56cf0>"}}, {"filename": "/home/runner/work/AWA-App/AWA-App/services/api/roi_repository.py", "lineno": 45, "name": "fetch_roi_rows", "line": "", "locals": {"session": "<test_cors._get_app.<locals>.FakeSession object at 0x7f6571a56cf0>", "roi_min": "0.0", "vendor": "None", "category": "None"}}]}]}
2025-08-19T13:59:11.8351738Z WARNING  urllib3.connectionpool:connectionpool.py:868 Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7f6570725430>: Failed to resolve 'selfhosted.invalid' ([Errno -2] Name or service not known)")': /api/1/envelope/
2025-08-19T13:59:11.8354292Z WARNING  urllib3.connectionpool:connectionpool.py:868 Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7f6570726db0>: Failed to resolve 'selfhosted.invalid' ([Errno -2] Name or service not known)")': /api/1/envelope/
2025-08-19T13:59:12.3169869Z WARNING  urllib3.connectionpool:connectionpool.py:868 Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NameResolutionError("<urllib3.connection.HTTPConnection object at 0x7f6570748bf0>: Failed to resolve 'selfhosted.invalid' ([Errno -2] Name or service not known)")': /api/1/envelope/
2025-08-19T13:59:12.3172337Z Sentry is attempting to send 0 pending events
2025-08-19T13:59:12.3172802Z Waiting up to True seconds
2025-08-19T13:59:12.3173265Z Press Ctrl-C to quit
2025-08-19T13:59:12.3173921Z =============================== warnings summary ===============================
2025-08-19T13:59:12.3174628Z services/alert_bot/tests/test_smoke.py:5
2025-08-19T13:59:12.3177096Z   /home/runner/work/AWA-App/AWA-App/services/alert_bot/tests/test_smoke.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-08-19T13:59:12.3179203Z     import pkg_resources  # noqa: F401
2025-08-19T13:59:12.3179701Z 
2025-08-19T13:59:12.3180021Z tests/api/test_ingest_endpoints.py: 12 warnings
2025-08-19T13:59:12.3180646Z tests/ingest/test_tasks_eager.py: 3 warnings
2025-08-19T13:59:12.3181199Z tests/test_api_fast.py: 1 warning
2025-08-19T13:59:12.3181755Z tests/test_health.py: 5 warnings
2025-08-19T13:59:12.3182247Z tests/test_smoke.py: 5 warnings
2025-08-19T13:59:12.3182770Z services/api/tests/test_cors.py: 1 warning
2025-08-19T13:59:12.3183404Z services/api/tests/test_errors_json.py: 2 warnings
2025-08-19T13:59:12.3184041Z services/api/tests/test_health.py: 1 warning
2025-08-19T13:59:12.3184683Z services/api/tests/test_rate_limit.py: 122 warnings
2025-08-19T13:59:12.3185702Z services/api/tests/test_roi_basic_auth.py: 4 warnings
2025-08-19T13:59:12.3186400Z services/api/tests/test_sentry_event.py: 1 warning
2025-08-19T13:59:12.3187143Z services/api/tests/test_stats_contracts.py: 3 warnings
2025-08-19T13:59:12.3189163Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/asgi_correlation_id/extensions/sentry.py:27: DeprecationWarning: sentry_sdk.configure_scope is deprecated and will be removed in the next major version. Please consult our migration guide to learn how to migrate to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x#scope-configuring
2025-08-19T13:59:12.3191236Z     with configure_scope() as scope:
2025-08-19T13:59:12.3191425Z 
2025-08-19T13:59:12.3191612Z tests/api/test_ingest_endpoints.py: 3 warnings
2025-08-19T13:59:12.3192056Z tests/test_api_fast.py: 1 warning
2025-08-19T13:59:12.3192349Z tests/test_health.py: 5 warnings
2025-08-19T13:59:12.3192641Z tests/test_smoke.py: 5 warnings
2025-08-19T13:59:12.3193054Z services/api/tests/test_cors.py: 3 warnings
2025-08-19T13:59:12.3193551Z services/api/tests/test_errors_json.py: 2 warnings
2025-08-19T13:59:12.3194217Z services/api/tests/test_health.py: 1 warning
2025-08-19T13:59:12.3194939Z services/api/tests/test_rate_limit.py: 2 warnings
2025-08-19T13:59:12.3195710Z services/api/tests/test_roi_basic_auth.py: 4 warnings
2025-08-19T13:59:12.3196239Z services/api/tests/test_sentry_event.py: 1 warning
2025-08-19T13:59:12.3196978Z services/api/tests/test_stats_contracts.py: 3 warnings
2025-08-19T13:59:12.3198724Z   /opt/hostedtoolcache/Python/3.12.11/x64/lib/python3.12/site-packages/fastapi_limiter/__init__.py:89: DeprecationWarning: Call to deprecated close. (Use aclose() instead) -- Deprecated since version 5.0.1.
2025-08-19T13:59:12.3200117Z     await cls.redis.close()
2025-08-19T13:59:12.3200405Z 
2025-08-19T13:59:12.3200756Z tests/test_api_fast.py::test_health_endpoint
2025-08-19T13:59:12.3202924Z   /home/runner/work/AWA-App/AWA-App/tests/test_api_fast.py:13: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3204607Z     return datetime.datetime.utcnow()
2025-08-19T13:59:12.3204960Z 
2025-08-19T13:59:12.3205208Z tests/test_api_fast.py: 1 warning
2025-08-19T13:59:12.3205524Z tests/test_health.py: 5 warnings
2025-08-19T13:59:12.3205902Z tests/test_smoke.py: 5 warnings
2025-08-19T13:59:12.3206247Z services/api/tests/test_cors.py: 1 warning
2025-08-19T13:59:12.3206606Z services/api/tests/test_health.py: 1 warning
2025-08-19T13:59:12.3207057Z services/api/tests/test_rate_limit.py: 102 warnings
2025-08-19T13:59:12.3209479Z   /home/runner/work/AWA-App/AWA-App/services/api/routes/health.py:24: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3211480Z     app_now = datetime.utcnow().replace(tzinfo=timezone.utc)
2025-08-19T13:59:12.3211848Z 
2025-08-19T13:59:12.3212086Z tests/test_health.py::test_health[0]
2025-08-19T13:59:12.3212556Z tests/test_health.py::test_health[1]
2025-08-19T13:59:12.3213015Z tests/test_health.py::test_health[2]
2025-08-19T13:59:12.3213490Z tests/test_health.py::test_health[3]
2025-08-19T13:59:12.3213990Z tests/test_health.py::test_health[4]
2025-08-19T13:59:12.3215979Z   /home/runner/work/AWA-App/AWA-App/tests/test_health.py:22: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3218055Z     return datetime.datetime.utcnow()
2025-08-19T13:59:12.3218404Z 
2025-08-19T13:59:12.3218675Z tests/test_smoke.py::test_health[0]
2025-08-19T13:59:12.3219426Z tests/test_smoke.py::test_health[1]
2025-08-19T13:59:12.3220305Z tests/test_smoke.py::test_health[2]
2025-08-19T13:59:12.3220892Z tests/test_smoke.py::test_health[3]
2025-08-19T13:59:12.3221460Z tests/test_smoke.py::test_health[4]
2025-08-19T13:59:12.3223500Z   /home/runner/work/AWA-App/AWA-App/tests/test_smoke.py:32: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3225620Z     return datetime.datetime.utcnow()
2025-08-19T13:59:12.3225963Z 
2025-08-19T13:59:12.3226424Z services/api/tests/test_cors.py::test_cors_simple_get_allowed
2025-08-19T13:59:12.3228704Z   /home/runner/work/AWA-App/AWA-App/services/api/tests/test_cors.py:27: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3231125Z     return datetime.datetime.utcnow()
2025-08-19T13:59:12.3231491Z 
2025-08-19T13:59:12.3231889Z services/api/tests/test_health.py::test_health_route
2025-08-19T13:59:12.3233523Z   /home/runner/work/AWA-App/AWA-App/services/api/tests/test_health.py:14: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3234620Z     return datetime.datetime.utcnow()
2025-08-19T13:59:12.3234805Z 
2025-08-19T13:59:12.3235013Z services/api/tests/test_rate_limit.py: 102 warnings
2025-08-19T13:59:12.3236205Z   /home/runner/work/AWA-App/AWA-App/services/api/tests/test_rate_limit.py:33: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
2025-08-19T13:59:12.3237251Z     return datetime.datetime.utcnow()
2025-08-19T13:59:12.3237427Z 
2025-08-19T13:59:12.3237909Z services/api/tests/test_sentry_event.py::test_unhandled_exception_is_captured_and_tagged
2025-08-19T13:59:12.3240908Z   /home/runner/work/AWA-App/AWA-App/services/api/tests/test_sentry_event.py:47: SentryHubDeprecationWarning: `sentry_sdk.Hub` is deprecated and will be removed in a future major release. Please consult our 1.x to 2.x migration guide for details on how to migrate `Hub` usage to the new API: https://docs.sentry.io/platforms/python/migration/1.x-to-2.x
2025-08-19T13:59:12.3243193Z     hub = sentry_sdk.Hub.current
2025-08-19T13:59:12.3243502Z 
2025-08-19T13:59:12.3244016Z -- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2025-08-19T13:59:12.3244936Z ================================ tests coverage ================================
2025-08-19T13:59:12.3245872Z _______________ coverage: platform linux, python 3.12.11-final-0 _______________
2025-08-19T13:59:12.3246399Z 
2025-08-19T13:59:12.3246726Z Coverage XML written to file coverage.xml
2025-08-19T13:59:12.3247520Z Required test coverage of 65% reached. Total coverage: 65.37%
2025-08-19T13:59:12.3248165Z =========================== short test summary info ============================
2025-08-19T13:59:12.3249868Z FAILED services/api/tests/test_roi_basic_auth.py::test_roi_basic_auth_good - TypeError: _get_app.<locals>.FakeSession.execute() takes 2 positional arguments but 3 were given
2025-08-19T13:59:12.7424597Z ##[error]Process completed with exit code 1.
