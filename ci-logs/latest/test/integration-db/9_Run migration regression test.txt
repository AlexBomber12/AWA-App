2025-08-21T17:53:36.7167100Z ##[group]Run pytest tests/migrations/test_migration_roundtrip.py -q -m integration --cov=services --cov-append --cov-fail-under=0 -o addopts=''
2025-08-21T17:53:36.7168083Z [36;1mpytest tests/migrations/test_migration_roundtrip.py -q -m integration --cov=services --cov-append --cov-fail-under=0 -o addopts=''[0m
2025-08-21T17:53:36.7208671Z shell: /usr/bin/bash -e {0}
2025-08-21T17:53:36.7208907Z env:
2025-08-21T17:53:36.7209083Z   PG_USER: postgres
2025-08-21T17:53:36.7209287Z   PG_PASSWORD: pass
2025-08-21T17:53:36.7209477Z   PG_DATABASE: awa
2025-08-21T17:53:36.7209667Z   PG_HOST: localhost
2025-08-21T17:53:36.7209863Z   PG_PORT: 5432
2025-08-21T17:53:36.7210326Z   PG_SYNC_DSN: ***localhost:5432/awa
2025-08-21T17:53:36.7210747Z   PG_ASYNC_DSN: ***localhost:5432/awa
2025-08-21T17:53:36.7211462Z   DATABASE_URL: ***localhost:5432/awa
2025-08-21T17:53:36.7211914Z   DATA_DIR: /tmp/awa-data
2025-08-21T17:53:36.7212130Z   ENABLE_LIVE: 0
2025-08-21T17:53:36.7212315Z   TESTING: 1
2025-08-21T17:53:36.7212557Z   pythonLocation: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-21T17:53:36.7213003Z   PKG_CONFIG_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib/pkgconfig
2025-08-21T17:53:36.7213399Z   Python_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-21T17:53:36.7213758Z   Python2_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-21T17:53:36.7214117Z   Python3_ROOT_DIR: /opt/hostedtoolcache/Python/3.11.13/x64
2025-08-21T17:53:36.7214475Z   LD_LIBRARY_PATH: /opt/hostedtoolcache/Python/3.11.13/x64/lib
2025-08-21T17:53:36.7214777Z ##[endgroup]
2025-08-21T17:53:41.1721488Z s                                                                        [100%]
2025-08-21T17:53:41.1722387Z ================================ tests coverage ================================
2025-08-21T17:53:41.1723311Z _______________ coverage: platform linux, python 3.11.13-final-0 _______________
2025-08-21T17:53:41.1723995Z 
2025-08-21T17:53:41.1724301Z Name                                                       Stmts   Miss  Cover
2025-08-21T17:53:41.1725091Z ------------------------------------------------------------------------------
2025-08-21T17:53:41.1726087Z services/__init__.py                                           0      0   100%
2025-08-21T17:53:41.1726811Z services/alert_bot/__init__.py                                 0      0   100%
2025-08-21T17:53:41.1727441Z services/alert_bot/alert_bot.py                               22     22     0%
2025-08-21T17:53:41.1728068Z services/alert_bot/rules/__init__.py                          63     63     0%
2025-08-21T17:53:41.1728656Z services/api/__init__.py                                       0      0   100%
2025-08-21T17:53:41.1729207Z services/api/config.py                                        24     24     0%
2025-08-21T17:53:41.1729753Z services/api/db.py                                            16     16     0%
2025-08-21T17:53:41.1730303Z services/api/errors.py                                        39     39     0%
2025-08-21T17:53:41.1731113Z services/api/logging_config.py                                15     15     0%
2025-08-21T17:53:41.1731735Z services/api/main.py                                         123    123     0%
2025-08-21T17:53:41.1732313Z services/api/models/__init__.py                                0      0   100%
2025-08-21T17:53:41.1732920Z services/api/models/fee.py                                    11     11     0%
2025-08-21T17:53:41.1733522Z services/api/roi_repository.py                                21     21     0%
2025-08-21T17:53:41.1734137Z services/api/routes/__init__.py                                0      0   100%
2025-08-21T17:53:41.1734752Z services/api/routes/health.py                                 19     19     0%
2025-08-21T17:53:41.1735396Z services/api/routes/repository.py                             16     16     0%
2025-08-21T17:53:41.1736046Z services/api/routes/roi.py                                    77     77     0%
2025-08-21T17:53:41.1736598Z services/api/routes/score.py                                  56     56     0%
2025-08-21T17:53:41.1737357Z services/api/routes/stats.py                                  49     49     0%
2025-08-21T17:53:41.1737788Z services/api/security.py                                      10     10     0%
2025-08-21T17:53:41.1738211Z services/api/sentry_config.py                                 65     65     0%
2025-08-21T17:53:41.1738641Z services/common/__init__.py                                    4      0   100%
2025-08-21T17:53:41.1739047Z services/common/base.py                                        3      0   100%
2025-08-21T17:53:41.1739451Z services/common/config.py                                      4      4     0%
2025-08-21T17:53:41.1739849Z services/common/db.py                                         34     34     0%
2025-08-21T17:53:41.1740239Z services/common/db_url.py                                      4      4     0%
2025-08-21T17:53:41.1740802Z services/common/dsn.py                                        49     37    24%
2025-08-21T17:53:41.1741442Z services/common/keepa.py                                       7      4    43%
2025-08-21T17:53:41.1741851Z services/common/llm.py                                        65     65     0%
2025-08-21T17:53:41.1742285Z services/common/models_vendor.py                              24      0   100%
2025-08-21T17:53:41.1742723Z services/common/settings.py                                   20     20     0%
2025-08-21T17:53:41.1743121Z services/db/__init__.py                                        0      0   100%
2025-08-21T17:53:41.1743511Z services/db/utils/__init__.py                                  0      0   100%
2025-08-21T17:53:41.1743923Z services/db/utils/views.py                                     5      5     0%
2025-08-21T17:53:41.1744340Z services/emailer/__init__.py                                   4      4     0%
2025-08-21T17:53:41.1744766Z services/emailer/generate_body.py                              3      3     0%
2025-08-21T17:53:41.1745180Z services/etl/__init__.py                                       9      9     0%
2025-08-21T17:53:41.1745554Z services/etl/db.py                                             2      2     0%
2025-08-21T17:53:41.1745950Z services/etl/dialects/__init__.py                              9      9     0%
2025-08-21T17:53:41.1746406Z services/etl/dialects/amazon_ads_sp_cost.py                   31     31     0%
2025-08-21T17:53:41.1746871Z services/etl/dialects/amazon_fee_preview.py                   30     30     0%
2025-08-21T17:53:41.1747336Z services/etl/dialects/amazon_inventory_ledger.py              28     28     0%
2025-08-21T17:53:41.1747802Z services/etl/dialects/amazon_reimbursements.py                16     16     0%
2025-08-21T17:53:41.1748267Z services/etl/dialects/amazon_returns.py                       16     16     0%
2025-08-21T17:53:41.1748728Z services/etl/dialects/amazon_settlements.py                   27     27     0%
2025-08-21T17:53:41.1749190Z services/etl/dialects/schemas.py                              25     25     0%
2025-08-21T17:53:41.1749649Z services/etl/dialects/test_generic.py                         15     15     0%
2025-08-21T17:53:41.1750094Z services/etl/fba_fee_ingestor.py                              33     33     0%
2025-08-21T17:53:41.1750515Z services/etl/healthcheck.py                                   27     27     0%
2025-08-21T17:53:41.1751144Z services/etl/keepa_ingestor.py                                47     47     0%
2025-08-21T17:53:41.1751881Z services/etl/sp_fees_ingestor.py                              39     39     0%
2025-08-21T17:53:41.1752295Z services/fees_h10/__init__.py                                  0      0   100%
2025-08-21T17:53:41.1752698Z services/fees_h10/client.py                                   12     12     0%
2025-08-21T17:53:41.1753115Z services/fees_h10/repository.py                               39     39     0%
2025-08-21T17:53:41.1753535Z services/fees_h10/worker.py                                   47     47     0%
2025-08-21T17:53:41.1753933Z services/ingest/__init__.py                                    0      0   100%
2025-08-21T17:53:41.1754506Z services/ingest/celery_app.py                                 29     29     0%
2025-08-21T17:53:41.1754922Z services/ingest/copy_loader.py                                57     57     0%
2025-08-21T17:53:41.1755350Z services/ingest/email_watcher.py                              50     50     0%
2025-08-21T17:53:41.1755787Z services/ingest/healthcheck.py                                42     42     0%
2025-08-21T17:53:41.1756226Z services/ingest/ingest_router.py                               8      8     0%
2025-08-21T17:53:41.1756662Z services/ingest/maintenance.py                                31     31     0%
2025-08-21T17:53:41.1757073Z services/ingest/tasks.py                                      56     56     0%
2025-08-21T17:53:41.1757490Z services/ingest/upload_router.py                              22     22     0%
2025-08-21T17:53:41.1758029Z services/llm_server/__init__.py                                0      0   100%
2025-08-21T17:53:41.1758429Z services/llm_server/app.py                                    22     22     0%
2025-08-21T17:53:41.1758847Z services/logistics_etl/__init__.py                             0      0   100%
2025-08-21T17:53:41.1759266Z services/logistics_etl/__main__.py                             7      7     0%
2025-08-21T17:53:41.1759689Z services/logistics_etl/client.py                              20     20     0%
2025-08-21T17:53:41.1760115Z services/logistics_etl/cron.py                                11     11     0%
2025-08-21T17:53:41.1760529Z services/logistics_etl/db.py                                  13     13     0%
2025-08-21T17:53:41.1761070Z services/logistics_etl/dsn.py                                 33     33     0%
2025-08-21T17:53:41.1761485Z services/logistics_etl/flow.py                                14     14     0%
2025-08-21T17:53:41.1761925Z services/logistics_etl/repository.py                          50     50     0%
2025-08-21T17:53:41.1762365Z services/price_importer/__init__.py                            1      1     0%
2025-08-21T17:53:41.1762817Z services/price_importer/common/__init__.py                     2      2     0%
2025-08-21T17:53:41.1763272Z services/price_importer/common/base.py                         2      2     0%
2025-08-21T17:53:41.1763726Z services/price_importer/common/db_url.py                       6      6     0%
2025-08-21T17:53:41.1764192Z services/price_importer/common/models_vendor.py               22     22     0%
2025-08-21T17:53:41.1764646Z services/price_importer/import.py                             21     21     0%
2025-08-21T17:53:41.1765106Z services/price_importer/normaliser.py                         20     20     0%
2025-08-21T17:53:41.1765557Z services/price_importer/reader.py                             30     30     0%
2025-08-21T17:53:41.1766013Z services/price_importer/repository.py                         38     38     0%
2025-08-21T17:53:41.1766481Z services/price_importer/services_common/__init__.py            4      4     0%
2025-08-21T17:53:41.1766945Z services/price_importer/services_common/base.py                3      3     0%
2025-08-21T17:53:41.1767410Z services/price_importer/services_common/db.py                 34     34     0%
2025-08-21T17:53:41.1767870Z services/price_importer/services_common/db_url.py              4      4     0%
2025-08-21T17:53:41.1768329Z services/price_importer/services_common/dsn.py                27     27     0%
2025-08-21T17:53:41.1768790Z services/price_importer/services_common/keepa.py               7      7     0%
2025-08-21T17:53:41.1769249Z services/price_importer/services_common/llm.py                36     36     0%
2025-08-21T17:53:41.1769714Z services/price_importer/services_common/models_vendor.py      22     22     0%
2025-08-21T17:53:41.1770182Z services/price_importer/services_common/settings.py           19     19     0%
2025-08-21T17:53:41.1770624Z services/repricer/__init__.py                                  0      0   100%
2025-08-21T17:53:41.1771156Z services/repricer/app/__init__.py                              0      0   100%
2025-08-21T17:53:41.1771702Z services/repricer/app/deps.py                                  0      0   100%
2025-08-21T17:53:41.1772133Z services/repricer/app/logic.py                                 5      5     0%
2025-08-21T17:53:41.1772559Z services/repricer/app/main.py                                 20     20     0%
2025-08-21T17:53:41.1772991Z services/repricer/app/schemas.py                              10     10     0%
2025-08-21T17:53:41.1773384Z ------------------------------------------------------------------------------
2025-08-21T17:53:41.1773713Z TOTAL                                                       2102   2056     2%
2025-08-21T17:53:41.3144572Z 1 skipped in 0.46s
