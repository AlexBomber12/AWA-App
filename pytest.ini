[pytest]
addopts = -q --strict-markers --maxfail=1 --disable-warnings --cov=packages --cov=services --cov-branch --cov-report=term-missing --cov-report=xml:coverage.xml
testpaths = tests services
python_files = test_*.py
asyncio_mode = auto
markers =
    unit: fast, hermetic unit tests (no external I/O)
    integration: requires real DB/Redis
    live: talks to real external APIs or network (skipped by default)
    future: placeholders for not-yet-implemented behavior (often xfail)
    slow: very slow tests (skipped locally, run in CI)
    needs_wait_for_db: requires the real services.api.main._wait_for_db retry loop
    real_sleep: opt out of the global sleep shim
    real_lifespan: opt out of the global API lifespan shim
